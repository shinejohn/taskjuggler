# SiteHealth Scanner - Cursor Project Plan
## Complete Development Plan for SiteHealth Scanner Integration

**Project:** SiteHealth Scanner (scanner-web)  
**Platform:** Task Juggler (Vue 3 + Laravel 12 + AWS)  
**Design System:** Fibonacco v1.0  
**Created:** December 27, 2025  
**Based On:** Business Plan, AWS Infrastructure, Task Juggler Handoff

---

## PROJECT OVERVIEW

SiteHealth Scanner is a comprehensive website testing service that identifies accessibility violations, broken functionality, SEO issues, and performance problems—with a specific focus on catching common mistakes generated by AI coding tools (Cursor, GitHub Copilot, Claude, v0, etc.).

### Key Differentiators
- **Built for AI Code Era**: Specific detection of AI-generated code patterns
- **Plain English Reports**: No developer jargon
- **AI-Powered Fix Generation**: Uses Claude API to generate exact code fixes
- **Continuous Monitoring**: Weekly/daily monitoring with regression alerts
- **Local Business Focus**: Pre-built checks for common business patterns
- **Legal Protection**: Compliance certificates and audit trails

### Business Context
- **Target Market**: SMB website owners (via Fibonacco), web agencies, in-house marketing teams
- **Pricing**: Free tier, Pro ($49/mo), Agency ($149/mo), Enterprise (custom)
- **Revenue Potential**: $50K-500K ARR within 18 months
- **Strategic Fit**: Direct integration with Fibonacco's Alphasite website service

---

## ARCHITECTURE OVERVIEW

### Platform Structure
```
taskjuggler-platform/
├── taskjuggler-api/          # Laravel 12 Backend (add SiteHealth module)
│   └── app/Modules/SiteHealth/
├── scanner-web/              # NEW: Vue 3 Frontend
├── scanner-worker/           # NEW: Node.js Playwright Scanner
├── scanner-mcp/              # NEW: MCP Server for Cursor/Claude
├── taskjuggler-web/          # Reference for patterns
├── shared/                   
│   └── design-system/        # Fibonacco Design System
└── infrastructure/           # AWS Pulumi (add scanner resources)
```

### Technology Stack
- **Frontend**: Vue 3 + TypeScript + Vite + Tailwind CSS
- **Backend**: Laravel 12 (add SiteHealth module)
- **Scanner Engine**: Node.js + Playwright + axe-core + Lighthouse
- **Queue**: AWS SQS
- **Storage**: AWS S3 (screenshots, PDFs)
- **Database**: PostgreSQL (shared RDS)
- **Cache**: Redis (shared ElastiCache)
- **AI**: Claude API (fix generation)
- **Deployment**: AWS ECS Fargate
- **Infrastructure**: Pulumi/Python

---

## PHASE 1: PROJECT SETUP & FOUNDATION (Week 1)

### 1.1 Initialize Frontend Project

**Commands:**
```bash
cd /Users/johnshine/Dropbox/Fibonacco/taskjuggler/Code
npm create vite@latest scanner-web -- --template vue-ts
cd scanner-web
npm install vue-router@4 pinia axios
npm install -D tailwindcss postcss autoprefixer @types/node
npx tailwindcss init -p
```

**Deliverables:**
- [ ] Project initialized with Vite + Vue 3 + TypeScript
- [ ] Dependencies installed
- [ ] Basic project structure created

### 1.2 Copy Design System & Base Components

**Commands:**
```bash
# Copy design system CSS
cp ../taskjuggler-web/src/assets/css/design-system.css src/assets/css/

# Copy base UI components
cp -r ../taskjuggler-web/src/components/ui src/components/
```

**Deliverables:**
- [ ] Design system CSS copied
- [ ] Base UI components copied (Button, Card, Input, Badge, Modal, Avatar, LoadingSpinner)
- [ ] Components verified and working

### 1.3 Configure Tailwind CSS

**File:** `tailwind.config.js`

**Configuration:**
```javascript
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    './index.html',
    './src/**/*.{vue,js,ts,jsx,tsx}',
  ],
  darkMode: 'class',
  theme: {
    extend: {
      colors: {
        // SiteHealth brand colors
        primary: {
          DEFAULT: '#10B981', // Green for health
          hover: '#059669',
          light: 'rgba(16, 185, 129, 0.1)',
        },
        // Severity colors
        critical: '#EF4444',
        serious: '#F59E0B', 
        moderate: '#3B82F6',
        minor: '#6B7280',
        // Design system mappings
        'bg-primary': 'var(--color-bg-primary)',
        'bg-secondary': 'var(--color-bg-secondary)',
        'text-primary': 'var(--color-text-primary)',
        'text-secondary': 'var(--color-text-secondary)',
        'surface-glass': 'var(--color-surface-glass)',
        border: 'var(--color-border)',
      },
      spacing: {
        '1': 'var(--space-1)',
        '2': 'var(--space-2)',
        // ... all spacing tokens
      },
      borderRadius: {
        'sm': 'var(--radius-sm)',
        'md': 'var(--radius-md)',
        'lg': 'var(--radius-lg)',
        'xl': 'var(--radius-xl)',
      },
      boxShadow: {
        '1': 'var(--shadow-1)',
        '2': 'var(--shadow-2)',
        '3': 'var(--shadow-3)',
      },
      fontFamily: {
        sans: ['var(--font-sans)', 'sans-serif'],
      },
    },
  },
  plugins: [],
}
```

**Deliverables:**
- [ ] Tailwind configured with design tokens
- [ ] Design system colors mapped
- [ ] Spacing, radius, shadows configured

### 1.4 Configure Vite

**File:** `vite.config.ts`

```typescript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import path from 'path'

export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
    },
  },
  server: {
    port: 3002,
    proxy: {
      '/api': {
        target: process.env.VITE_API_URL || 'http://localhost:8000',
        changeOrigin: true,
      },
    },
  },
  build: {
    outDir: 'dist',
    sourcemap: true,
  },
})
```

**Deliverables:**
- [ ] Vite configured
- [ ] Path aliases set up
- [ ] API proxy configured

### 1.5 Set Up Environment Variables

**File:** `.env.example`
```
VITE_API_URL=https://api.taskjuggler.com
VITE_APP_NAME=SiteHealth
VITE_APP_SLUG=scanner
```

**Deliverables:**
- [ ] `.env.example` created
- [ ] `.env` file created (local development)

### 1.6 Create TypeScript Types

**File:** `src/types/index.ts`

**Types Required:**
- `Site` - Site configuration and metadata
- `Scan` - Scan execution and results
- `Issue` - Individual issues found
- `ScheduledScan` - Recurring scan configuration
- `DashboardStats` - Dashboard statistics
- `AuthConfig` - Authentication configuration for protected sites
- `CategoryScores` - Scores by category (accessibility, SEO, etc.)
- `IssueCategory`, `IssueSeverity`, `IssueStatus` - Enums

**Deliverables:**
- [ ] All TypeScript types defined
- [ ] Types exported from index.ts
- [ ] Types match backend API structure

### 1.7 Set Up API Client

**File:** `src/api/client.ts`

**Features:**
- Axios instance with base URL
- Request interceptor for auth token
- Response interceptor for error handling
- 401 redirect to login

**Deliverables:**
- [ ] API client created
- [ ] Auth interceptor working
- [ ] Error handling configured

### 1.8 Set Up Router

**File:** `src/router/index.ts`

**Routes:**
- `/` - Dashboard
- `/sites` - Sites list
- `/sites/:id` - Site detail
- `/scans/:id` - Scan detail
- `/settings` - Settings

**Deliverables:**
- [ ] Router configured
- [ ] Auth guards implemented
- [ ] Route meta tags set

### 1.9 Set Up Pinia Stores

**Stores Required:**
- `auth.ts` - Authentication (import from platform or copy)
- `sites.ts` - Site management
- `scans.ts` - Scan management
- `issues.ts` - Issue management

**Deliverables:**
- [ ] All stores created
- [ ] Store actions implemented
- [ ] Store getters implemented

---

## PHASE 2: FRONTEND COMPONENTS (Week 2)

### 2.1 Scanner-Specific Components

**Components to Create:**

1. **HealthScore.vue**
   - Circular progress indicator
   - Score display (0-100)
   - Status labels (Healthy, Needs Work, Critical)
   - Size variants (sm, md, lg)
   - Color coding by score

2. **SiteCard.vue**
   - Site name and URL
   - Health score display
   - Issue count
   - Last scan timestamp
   - Quick scan button
   - Status badge

3. **IssueCard.vue**
   - Issue title and message
   - Severity badge
   - Category badge
   - Expandable details
   - Page URL and selector
   - WCAG criteria
   - HTML context
   - Fix generation button
   - Status actions (ignore, mark fixed)

4. **FixPreview.vue**
   - Before/after code comparison
   - Fix explanation
   - Confidence score
   - Copy fix button

5. **AddSiteModal.vue**
   - URL input
   - Site name input
   - Auth configuration (none, basic, cookie, header)
   - Scan settings (checks, max pages)
   - Form validation

6. **IssueList.vue**
   - Filterable list of issues
   - Group by category/severity
   - Bulk actions
   - Pagination

7. **ScoreChart.vue**
   - Historical score visualization
   - Category breakdown
   - Trend indicators

**Deliverables:**
- [ ] All scanner components created
- [ ] Components use design system
- [ ] Components are accessible
- [ ] Components support dark mode

### 2.2 Layout Components

**Components:**
- `AppLayout.vue` - Main app layout
- `SideNav.vue` - Side navigation
- `TopBar.vue` - Top navigation bar

**Deliverables:**
- [ ] Layout components created
- [ ] Navigation working
- [ ] Responsive design

### 2.3 Page Components

**Pages:**
1. **DashboardPage.vue**
   - Overview statistics
   - Sites grid
   - Recent scans
   - Sites needing attention

2. **SitesPage.vue**
   - Sites list/grid
   - Add site button
   - Filter and search
   - Bulk actions

3. **SiteDetailPage.vue**
   - Site overview
   - Health score display
   - Category breakdown
   - Recent scans list
   - Open issues list
   - Scan trigger button

4. **ScanDetailPage.vue**
   - Scan information
   - Score breakdown
   - Issues list
   - Report download
   - Comparison with previous scan

5. **SettingsPage.vue**
   - Site settings
   - Scan schedules
   - Notification preferences
   - API keys

**Deliverables:**
- [ ] All pages created
- [ ] Pages use layout components
- [ ] Pages fetch and display data
- [ ] Loading and error states handled

---

## PHASE 3: BACKEND INTEGRATION (Week 3)

### 3.1 Add SiteHealth Module to Laravel API

**Directory Structure:**
```
app/Modules/SiteHealth/
├── Models/
│   ├── Site.php
│   ├── Scan.php
│   ├── Issue.php
│   └── ScheduledScan.php
├── Http/
│   ├── Controllers/
│   │   ├── SiteController.php
│   │   ├── ScanController.php
│   │   ├── IssueController.php
│   │   ├── ScheduleController.php
│   │   └── DashboardController.php
│   ├── Requests/
│   │   ├── StoreSiteRequest.php
│   │   ├── UpdateSiteRequest.php
│   │   └── StoreScanRequest.php
│   └── Resources/
│       ├── SiteResource.php
│       ├── ScanResource.php
│       └── IssueResource.php
├── Services/
│   ├── ScannerService.php
│   └── FixGeneratorService.php
├── Jobs/
│   ├── ProcessScan.php
│   ├── GenerateFix.php
│   └── GenerateReport.php
└── Providers/
    └── SiteHealthServiceProvider.php
```

**Deliverables:**
- [ ] Module structure created
- [ ] Models created with relationships
- [ ] Controllers implemented
- [ ] Form requests for validation
- [ ] API resources for responses
- [ ] Service classes created

### 3.2 Database Migrations

**Migrations Required:**
- `create_sites_table`
- `create_scans_table`
- `create_issues_table`
- `create_scheduled_scans_table`

**Deliverables:**
- [ ] All migrations created
- [ ] Migrations tested
- [ ] Foreign keys configured
- [ ] Indexes added

### 3.3 API Routes

**File:** `routes/api.php`

**Routes:**
```php
Route::prefix('scanner')->middleware('auth:sanctum')->group(function () {
    // Dashboard
    Route::get('/dashboard', [DashboardController::class, 'index']);
    
    // Sites
    Route::apiResource('sites', SiteController::class);
    Route::post('/sites/{site}/scan', [ScanController::class, 'store']);
    Route::get('/sites/{site}/scans', [ScanController::class, 'index']);
    Route::get('/sites/{site}/compare', [ScanController::class, 'compare']);
    
    // Scans
    Route::get('/scans/{scan}', [ScanController::class, 'show']);
    Route::get('/scans/{scan}/report', [ScanController::class, 'report']);
    
    // Issues
    Route::get('/issues', [IssueController::class, 'index']);
    Route::get('/issues/{issue}', [IssueController::class, 'show']);
    Route::put('/issues/{issue}', [IssueController::class, 'update']);
    Route::post('/issues/{issue}/fix', [IssueController::class, 'generateFix']);
    Route::post('/issues/bulk', [IssueController::class, 'bulkUpdate']);
    
    // Schedules
    Route::get('/sites/{site}/schedules', [ScheduleController::class, 'index']);
    Route::post('/sites/{site}/schedules', [ScheduleController::class, 'store']);
    Route::put('/schedules/{schedule}', [ScheduleController::class, 'update']);
    Route::delete('/schedules/{schedule}', [ScheduleController::class, 'destroy']);
});
```

**Deliverables:**
- [ ] Routes registered
- [ ] Middleware applied
- [ ] Route names consistent

### 3.4 SQS Integration

**Job:** `ProcessScan.php`

**Features:**
- Receives scan request
- Sends message to SQS queue
- Returns scan ID immediately
- Scanner worker processes from queue

**Deliverables:**
- [ ] SQS queue configured
- [ ] Job dispatches to queue
- [ ] Error handling implemented

### 3.5 Claude API Integration

**Service:** `FixGeneratorService.php`

**Features:**
- Takes issue details
- Sends to Claude API
- Receives fix code and explanation
- Stores fix with confidence score

**Deliverables:**
- [ ] Claude API client configured
- [ ] Fix generation working
- [ ] Error handling implemented
- [ ] Rate limiting considered

---

## PHASE 4: SCANNER WORKER (Week 4)

### 4.1 Scanner Worker Setup

**Technology:** Node.js + TypeScript + Playwright

**Dependencies:**
- `playwright` - Browser automation
- `@axe-core/playwright` - Accessibility testing
- `lighthouse` - Performance testing
- `aws-sdk` - SQS and S3 integration
- `pg` - PostgreSQL client

**Deliverables:**
- [ ] Project initialized
- [ ] Dependencies installed
- [ ] TypeScript configured

### 4.2 Scanner Engine

**Core Functionality:**
1. **Crawling**
   - Start from root URL
   - Follow links (respect robots.txt)
   - Handle authentication (basic, cookie, header)
   - Limit pages per scan
   - Timeout handling

2. **Accessibility Testing**
   - Use axe-core
   - Check WCAG 2.1 AA compliance
   - Capture violations with selectors
   - Store HTML context

3. **Broken Link Detection**
   - Check all links
   - Detect 404s, redirects
   - External link validation
   - Anchor link validation

4. **Form Testing**
   - Check for labels
   - Test submission
   - Error handling
   - Validation

5. **SEO Analysis**
   - Title tags
   - Meta descriptions
   - Heading structure
   - Schema markup
   - Image alt text

6. **Performance Testing**
   - Lighthouse scores
   - Core Web Vitals
   - Image optimization
   - Resource loading

7. **Security Checks**
   - HTTPS enforcement
   - Security headers
   - Mixed content
   - CSP headers

**Deliverables:**
- [ ] All check types implemented
- [ ] Results stored in database
- [ ] Screenshots saved to S3
- [ ] Error handling robust

### 4.3 Docker Configuration

**File:** `scanner-worker/Dockerfile`

```dockerfile
FROM mcr.microsoft.com/playwright:v1.40.0-jammy

WORKDIR /app

# Install Node.js 20
RUN apt-get update && apt-get install -y curl \
    && curl -fsSL https://deb.nodesource.com/setup_20.x | bash - \
    && apt-get install -y nodejs \
    && rm -rf /var/lib/apt/lists/*

# Copy package files
COPY package*.json ./

# Install dependencies
RUN npm ci --production

# Copy source
COPY . .

# Build TypeScript
RUN npm run build

# Run as non-root user
USER pwuser

# Start worker
CMD ["node", "dist/worker.js"]
```

**Deliverables:**
- [ ] Dockerfile created
- [ ] Image builds successfully
- [ ] Worker runs in container

### 4.4 Worker Queue Processing

**Features:**
- Polls SQS queue
- Processes scan jobs
- Updates scan status
- Handles errors gracefully
- Dead letter queue for failures

**Deliverables:**
- [ ] Queue polling implemented
- [ ] Job processing working
- [ ] Error handling robust
- [ ] Dead letter queue configured

---

## PHASE 5: AWS INFRASTRUCTURE (Week 5)

### 5.1 Add Scanner Resources to Pulumi

**Resources Required:**

1. **ECS Services**
   - Scanner worker service (scales based on SQS queue)
   - Uses FARGATE_SPOT for cost savings

2. **SQS Queue**
   - Scan job queue
   - Dead letter queue
   - CloudWatch alarms

3. **S3 Bucket**
   - Screenshots storage
   - PDF reports storage
   - Lifecycle policies

4. **IAM Roles**
   - ECS task execution role
   - ECS task role (SQS, S3 access)
   - Scanner worker permissions

5. **CloudWatch**
   - Log groups
   - Metrics
   - Alarms

**Deliverables:**
- [ ] All resources added to Pulumi
- [ ] Infrastructure deployed
- [ ] Permissions configured
- [ ] Monitoring set up

### 5.2 ECR Repositories

**Repositories:**
- `sitehealth/scanner` - Scanner worker image

**Deliverables:**
- [ ] ECR repositories created
- [ ] Images pushed
- [ ] ECS services using images

### 5.3 Auto Scaling

**Configuration:**
- Scanner workers scale based on SQS queue depth
- Min: 0 (scale to zero)
- Max: 20 concurrent scanners
- Target: 2 messages per scanner

**Deliverables:**
- [ ] Auto scaling configured
- [ ] Scaling policies working
- [ ] Cost optimization (FARGATE_SPOT)

---

## PHASE 6: MCP SERVER (Week 6)

### 6.1 MCP Server Setup

**Purpose:** Enable Cursor/Claude to interact with SiteHealth Scanner

**Features:**
- Scan website from Cursor
- View scan results
- Generate fixes
- Manage sites

**Deliverables:**
- [ ] MCP server created
- [ ] Tools implemented
- [ ] Authentication configured
- [ ] Documentation written

---

## PHASE 7: TESTING & POLISH (Week 7-8)

### 7.1 Unit Tests

**Coverage:**
- Components
- Stores
- Utilities
- API clients

**Deliverables:**
- [ ] Unit tests written
- [ ] Coverage > 80%
- [ ] Tests passing

### 7.2 Integration Tests

**Coverage:**
- API endpoints
- Database operations
- Queue processing
- S3 operations

**Deliverables:**
- [ ] Integration tests written
- [ ] Tests passing
- [ ] Mock data configured

### 7.3 E2E Tests

**Coverage:**
- User workflows
- Scan execution
- Fix generation
- Report viewing

**Deliverables:**
- [ ] E2E tests written
- [ ] Tests passing
- [ ] CI/CD configured

### 7.4 Performance Optimization

**Areas:**
- Frontend bundle size
- API response times
- Scanner performance
- Database queries

**Deliverables:**
- [ ] Bundle optimized
- [ ] API optimized
- [ ] Scanner optimized
- [ ] Database indexed

### 7.5 Accessibility Audit

**Check:**
- Keyboard navigation
- Screen reader compatibility
- Color contrast
- Touch targets (44px minimum)

**Deliverables:**
- [ ] Accessibility audit passed
- [ ] Issues fixed
- [ ] WCAG 2.1 AA compliant

---

## PHASE 8: DEPLOYMENT & LAUNCH (Week 9-10)

### 8.1 Production Deployment

**Steps:**
1. Build frontend
2. Build scanner worker
3. Push images to ECR
4. Deploy infrastructure
5. Run migrations
6. Configure DNS
7. Set up SSL

**Deliverables:**
- [ ] All services deployed
- [ ] DNS configured
- [ ] SSL working
- [ ] Monitoring active

### 8.2 Beta Testing

**Activities:**
- Internal testing
- Beta user testing
- Feedback collection
- Bug fixes

**Deliverables:**
- [ ] Beta testing complete
- [ ] Feedback incorporated
- [ ] Bugs fixed

### 8.3 Public Launch

**Activities:**
- Product Hunt launch
- Marketing site
- Documentation
- Support setup

**Deliverables:**
- [ ] Public launch complete
- [ ] Marketing materials ready
- [ ] Documentation published
- [ ] Support channels active

---

## DEVELOPMENT RULES & GUIDELINES

### Design System
1. **Always use design system tokens** - Never hardcode colors, spacing, etc.
2. **Apply glass effects** - Use `.glass-standard` or `.glass-prominent` for cards
3. **Support dark mode** - Automatic via design system tokens
4. **Accessibility first** - 44px touch targets, ARIA labels, keyboard nav

### Code Quality
1. **TypeScript strict mode** - No `any` types
2. **Component composition** - Extend base components
3. **Error handling** - Always handle errors gracefully
4. **Loading states** - Show loading indicators
5. **Empty states** - Handle empty data gracefully

### API Patterns
1. **Consistent endpoints** - Follow REST conventions
2. **Error responses** - Standard error format
3. **Pagination** - Use Laravel pagination
4. **Validation** - Form requests for validation
5. **Resources** - API resources for responses

### Testing
1. **Unit tests** - All components and utilities
2. **Integration tests** - All API endpoints
3. **E2E tests** - Critical user workflows
4. **Test coverage** - Minimum 80%

---

## KEY FILES REFERENCE

### Documentation
- `SITE_SCANNER_BUSINESS_PLAN.md` - Business plan and strategy
- `SITEHEALTH_AWS_INFRASTRUCTURE.md` - Complete AWS infrastructure guide
- `SITEHEALTH_TASKJUGGLER_HANDOFF.md` - Detailed handoff package
- `PLATFORM_INTEGRATION_GUIDE.md` - Platform integration guide
- `CURSOR_INSTRUCTIONS_TEMPLATE.md` - Cursor instructions template

### Code References
- `taskjuggler-web/src/` - Reference implementation
- `process-web/src/` - Example integration
- `projects-web/src/` - Example integration

---

## SUCCESS CRITERIA

### MVP (Minimum Viable Product)
- [ ] Can add a site
- [ ] Can trigger a scan
- [ ] Can view scan results
- [ ] Can see issues
- [ ] Can generate fixes
- [ ] Basic dashboard working

### Full Product
- [ ] All features from business plan
- [ ] Scheduled scans working
- [ ] PDF reports generated
- [ ] Email notifications
- [ ] API access
- [ ] White-label reports
- [ ] Compliance certificates

### Production Ready
- [ ] All tests passing
- [ ] Performance optimized
- [ ] Security hardened
- [ ] Monitoring configured
- [ ] Documentation complete
- [ ] Support channels ready

---

## TIMELINE SUMMARY

| Phase | Duration | Key Deliverables |
|-------|----------|------------------|
| Phase 1: Setup | Week 1 | Project initialized, design system integrated |
| Phase 2: Components | Week 2 | All UI components created |
| Phase 3: Backend | Week 3 | API endpoints and services |
| Phase 4: Scanner | Week 4 | Scanner worker functional |
| Phase 5: Infrastructure | Week 5 | AWS resources deployed |
| Phase 6: MCP Server | Week 6 | MCP server working |
| Phase 7: Testing | Week 7-8 | All tests passing |
| Phase 8: Launch | Week 9-10 | Production deployment |

**Total Timeline: 10 weeks**

---

## NEXT STEPS

1. **Start Phase 1** - Initialize project and set up foundation
2. **Review Business Plan** - Understand requirements and priorities
3. **Set Up Development Environment** - Local development ready
4. **Begin Component Development** - Start with HealthScore component
5. **Iterate and Test** - Continuous testing and refinement

---

**This project plan should be stored in Cursor and referenced throughout development. Update as progress is made and requirements evolve.**
