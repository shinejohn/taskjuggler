import{a as O,o as N,b as U,w as B,r as m,p as t,m as l,q as b,y as o,c as h,s as v,v as y,u as S,x as _,F as w,e as j,A as I,D as P,E as V,f as i}from"./vue-vendor-lZgBCM-Y.js";import{_ as L}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-DdJPjlAv.js";import{u as R}from"./coordinators-BfbYYedD.js";import{useOrganizationsStore as E}from"./organizations-CvdzM5JO.js";import{a as u}from"./index-C8fGv0Lo.js";import{C as H,q}from"./ui-vendor-XL1sGzTt.js";import"./utils-vendor-D5GkNzM3.js";const C={getBillingInfo(a){return u.get(`/coordinator/organizations/${a}/billing`)},getHistory(a){return u.get(`/coordinator/organizations/${a}/billing/history`)},updatePaymentMethod(a,c){return u.put(`/coordinator/organizations/${a}/billing/payment-method`,{payment_method_id:c})},cancelSubscription(a){return u.post(`/coordinator/organizations/${a}/billing/cancel`)},subscribe(a,c){return u.post(`/coordinator/organizations/${a}/billing/subscribe`,{plan:c})},updateAddons(a,c){return u.post(`/coordinator/organizations/${a}/billing/addons`,{addons:c})}},K={class:"space-y-6"},T={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Y={class:"lg:col-span-2 space-y-6"},G={class:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden"},J={class:"bg-gradient-to-r from-[#1B4F72] to-[#2563EB] p-6 text-white"},Q={class:"flex justify-between items-start mb-4"},W={class:"text-2xl font-bold"},X={class:"px-3 py-1 rounded-full bg-white/20 text-xs font-medium flex items-center gap-1"},Z={class:"text-3xl font-bold mb-1"},tt={class:"text-sm opacity-90"},et={key:0,class:"text-xs opacity-75 mt-1"},st={class:"p-6"},ot={class:"space-y-3 mb-6"},nt={class:"flex items-center gap-3"},it={class:"w-8 h-8 rounded-full bg-blue-100 text-[#1B4F72] flex items-center justify-center font-bold text-xs"},at={class:"font-medium text-slate-900"},rt={class:"text-xs text-slate-500"},lt={class:"font-semibold text-slate-900"},dt={class:"flex gap-3"},ct={class:"flex gap-3"},ut={class:"bg-white rounded-xl border border-slate-200 shadow-sm p-6"},pt={class:"flex items-center justify-between p-4 bg-slate-50 rounded-lg border border-slate-200"},mt={class:"flex items-center gap-3"},ft={key:0},xt={class:"font-medium text-slate-900"},bt={class:"text-xs text-slate-500"},gt={key:1},ht={class:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden"},vt={class:"overflow-x-auto"},yt={class:"w-full text-sm text-left"},_t={class:"divide-y divide-slate-100"},wt={class:"px-6 py-4 text-slate-600"},Ct={class:"px-6 py-4 font-medium text-slate-900"},kt={class:"px-6 py-4 font-semibold text-slate-900"},zt={class:"px-6 py-4 text-right"},Bt=["onClick"],St={key:0},$t={key:1},Dt={class:"space-y-6"},Ft={class:"bg-white rounded-xl border border-slate-200 shadow-sm p-6"},At={class:"space-y-4"},Mt={class:"flex-1"},Ot={class:"font-semibold text-slate-900"},Nt={class:"text-sm text-slate-500"},Ut={class:"text-sm font-medium text-[#1B4F72] mt-1"},jt={class:"relative inline-flex items-center cursor-pointer"},It=["onUpdate:modelValue"],Tt=O({__name:"BillingPage",setup(a){const c=R(),r=E(),p=m(!1),d=m(null),g=m([]),f=m(!1),x=h(()=>c.coordinators.filter(n=>n.status==="active")),$=h(()=>d.value?.usage.monthly_cost||x.value.reduce((n,e)=>n+(e.monthly_price||0),0)),D=h(()=>{if(d.value?.subscription.current_period_end)return new Date(d.value.subscription.current_period_end).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});const n=new Date;return n.setMonth(n.getMonth()+1),n.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),F=m([{id:"recording",name:"Call Recording",description:"Record all calls for quality assurance",price:"$10/mo",enabled:!0},{id:"analytics",name:"Advanced Analytics",description:"Detailed reports and insights",price:"$15/mo",enabled:!1},{id:"support",name:"Priority Support",description:"24/7 priority customer support",price:"$25/mo",enabled:!1}]);function Pt(n){}async function A(){if(r.currentOrganization)try{await C.cancelSubscription(r.currentOrganization.id),p.value=!1,await k()}catch(n){console.error("Failed to cancel subscription:",n),alert(n.response?.data?.message||"Failed to cancel subscription")}}async function k(){if(r.currentOrganization){f.value=!0;try{const[n,e]=await Promise.all([C.getBillingInfo(r.currentOrganization.id),C.getHistory(r.currentOrganization.id)]);d.value=n.data,g.value=e.data.data}catch(n){console.error("Failed to fetch billing info:",n)}finally{f.value=!1}}}return N(async()=>{r.currentOrganization||(await r.fetchOrganizations(),r.organizations.length>0&&r.setCurrentOrganization(r.organizations[0])),r.currentOrganization&&(await c.fetchCoordinators(r.currentOrganization.id),await k())}),(n,e)=>{const M=j("router-link");return i(),U(L,null,{default:B(()=>[t("div",K,[e[20]||(e[20]=t("div",null,[t("h1",{class:"text-3xl font-heading font-bold text-[#1B4F72]"}," Billing "),t("p",{class:"text-slate-500 mt-1"}," Manage your subscription and payment methods ")],-1)),t("div",T,[t("div",Y,[t("div",G,[t("div",J,[t("div",Q,[t("div",null,[e[4]||(e[4]=t("div",{class:"text-sm opacity-90 mb-1"},"Current Plan",-1)),t("h2",W,o(x.value.length)+" Coordinator"+o(x.value.length!==1?"s":"")+" Active ",1)]),t("span",X,[v(S(H),{size:12}),e[5]||(e[5]=y(" Active ",-1))])]),t("div",Z,[y(" $"+o($.value)+" ",1),e[6]||(e[6]=t("span",{class:"text-lg font-normal opacity-90"},"/month",-1))]),t("div",tt," Next charge: "+o(D.value),1),d.value?.subscription.status?(i(),l("div",et," Status: "+o(d.value.subscription.status),1)):b("",!0)]),t("div",st,[e[8]||(e[8]=t("h3",{class:"font-semibold text-slate-900 mb-4"}," Coordinator Breakdown ",-1)),t("div",ot,[(i(!0),l(w,null,_(x.value,s=>(i(),l("div",{key:s.id,class:"flex justify-between items-center p-3 bg-slate-50 rounded-lg"},[t("div",nt,[t("div",it,o((s.display_name||s.role_template?.name||"C").charAt(0)),1),t("div",null,[t("div",at,o(s.display_name||s.role_template?.name||"Coordinator"),1),t("div",rt,o(s.role_template?.name||"Unknown Role"),1)])]),t("div",lt," $"+o(s.monthly_price)+"/mo ",1)]))),128))]),t("div",dt,[v(M,{to:"/coordinators",class:"flex-1 py-2.5 border border-slate-200 text-slate-700 font-medium rounded-lg hover:bg-slate-50 transition-colors text-center"},{default:B(()=>[...e[7]||(e[7]=[y(" Manage Coordinators ",-1)])]),_:1}),t("button",{onClick:e[0]||(e[0]=s=>p.value=!0),class:"flex-1 py-2.5 border border-red-200 text-red-600 font-medium rounded-lg hover:bg-red-50 transition-colors"}," Cancel Subscription ")])])]),p.value?(i(),l("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e[3]||(e[3]=s=>p.value=!1)},[t("div",{class:"bg-white rounded-xl p-8 max-w-md w-full mx-4",onClick:e[2]||(e[2]=I(()=>{},["stop"]))},[e[9]||(e[9]=t("h3",{class:"text-2xl font-bold text-slate-900 mb-4"},"Cancel Subscription",-1)),e[10]||(e[10]=t("p",{class:"text-slate-600 mb-6"}," Are you sure you want to cancel your subscription? You'll continue to have access until the end of your billing period. ",-1)),t("div",ct,[t("button",{onClick:e[1]||(e[1]=s=>p.value=!1),class:"flex-1 px-4 py-2 border border-slate-200 text-slate-700 font-medium rounded-lg hover:bg-slate-50"}," Keep Subscription "),t("button",{onClick:A,class:"flex-1 px-4 py-2 bg-red-600 text-white font-medium rounded-lg hover:bg-red-700"}," Cancel Subscription ")])])])):b("",!0),t("div",ut,[e[13]||(e[13]=t("h3",{class:"text-lg font-bold text-slate-900 mb-4"}," Payment Method ",-1)),t("div",pt,[t("div",mt,[v(S(q),{size:24,class:"text-slate-400"}),d.value?.payment_method?(i(),l("div",ft,[t("div",xt," •••• •••• •••• "+o(d.value.payment_method.last4),1),t("div",bt," Expires "+o(d.value.payment_method.exp_month)+"/"+o(d.value.payment_method.exp_year),1)])):(i(),l("div",gt,[...e[11]||(e[11]=[t("div",{class:"font-medium text-slate-900"},"No payment method",-1),t("div",{class:"text-xs text-slate-500"},"Add a payment method",-1)])]))]),e[12]||(e[12]=t("button",{class:"text-sm text-[#1B4F72] font-medium hover:underline"}," Update ",-1))])]),t("div",ht,[e[17]||(e[17]=t("div",{class:"p-6 border-b border-slate-100"},[t("h3",{class:"text-lg font-bold text-slate-900"},"Billing History")],-1)),t("div",vt,[t("table",yt,[e[16]||(e[16]=t("thead",{class:"bg-slate-50 text-slate-500 font-medium border-b border-slate-100"},[t("tr",null,[t("th",{class:"px-6 py-3"},"Date"),t("th",{class:"px-6 py-3"},"Description"),t("th",{class:"px-6 py-3"},"Amount"),t("th",{class:"px-6 py-3 text-right"},"Invoice")])],-1)),t("tbody",_t,[(i(!0),l(w,null,_(g.value,s=>(i(),l("tr",{key:s.id,class:"hover:bg-slate-50 transition-colors"},[t("td",wt,o(new Date(s.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})),1),t("td",Ct,o(s.description),1),t("td",kt,"$"+o(s.amount.toFixed(2)),1),t("td",zt,[t("button",{onClick:z=>void 0,class:"text-[#1B4F72] hover:underline text-sm font-medium"}," Download ",8,Bt)])]))),128)),g.value.length===0&&!f.value?(i(),l("tr",St,[...e[14]||(e[14]=[t("td",{colspan:"4",class:"px-6 py-8 text-center text-slate-500"}," No billing history ",-1)])])):b("",!0),f.value?(i(),l("tr",$t,[...e[15]||(e[15]=[t("td",{colspan:"4",class:"px-6 py-8 text-center text-slate-500"}," Loading... ",-1)])])):b("",!0)])])])])]),t("div",Dt,[t("div",Ft,[e[19]||(e[19]=t("h3",{class:"text-lg font-bold text-slate-900 mb-4"},"Add-ons",-1)),t("div",At,[(i(!0),l(w,null,_(F.value,s=>(i(),l("div",{key:s.id,class:"flex items-center justify-between p-4 border border-slate-200 rounded-lg"},[t("div",Mt,[t("div",Ot,o(s.name),1),t("div",Nt,o(s.description),1),t("div",Ut,o(s.price),1)]),t("label",jt,[P(t("input",{"onUpdate:modelValue":z=>s.enabled=z,type:"checkbox",class:"sr-only peer"},null,8,It),[[V,s.enabled]]),e[18]||(e[18]=t("div",{class:"w-11 h-6 bg-slate-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#1B4F72]/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[#1B4F72]"},null,-1))])]))),128))])])])])])]),_:1})}}});export{Tt as default};
