import{_ as U}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-DdJPjlAv.js";import{_ as C,a as A}from"./CardContent.vue_vue_type_script_setup_true_lang-BV8KmGM6.js";import{g as V,_ as D}from"./index-C1AbbWbk.js";import{_ as E}from"./Progress.vue_vue_type_script_setup_true_lang-D4YlrqfE.js";import{w as L,a7 as W,a8 as q,A as H,z as I,c as Q,U as X,a9 as Z,aa as G,a4 as J,ab as K,ac as Y,v as tt,ad as et}from"./ui-vendor-XL1sGzTt.js";import{a as P,b as g,u as t,n as x,w as a,s,p as n,m as c,q as y,z as st,v as i,y as m,F as z,x as S,Z as at,f as o,d as lt,r as w,o as nt,e as rt,c as R}from"./vue-vendor-lZgBCM-Y.js";import{_ as ot}from"./CoordinatorCard.vue_vue_type_script_setup_true_lang-yINn1rD-.js";import{_}from"./index-DjyVIXzc.js";import{_ as j}from"./CardTitle.vue_vue_type_script_setup_true_lang-C65XERRF.js";import{_ as it,a as dt,b as O,c as k,d as ut,e as p}from"./TableHeader.vue_vue_type_script_setup_true_lang-BUjGviFc.js";import{a as T}from"./index-C8fGv0Lo.js";import{useOrganizationsStore as N}from"./organizations-CvdzM5JO.js";import{u as ct}from"./coordinators-BfbYYedD.js";import{f as mt}from"./format-DaYpM1Fu.js";import"./index-Dt4uSB3H.js";import"./utils-vendor-D5GkNzM3.js";const ft={class:"flex justify-between items-start mb-4"},gt={class:"space-y-1"},xt={key:0,class:"text-xs text-slate-400 mt-1"},bt={key:1,class:"text-xs text-slate-400 mt-1"},vt={key:0,class:"mt-4"},ht={class:"flex justify-between text-xs text-slate-500 mb-2"},yt={key:1,class:"mt-4 h-12 flex items-end gap-0.5"},F=P({__name:"MetricCard",props:{label:{},value:{},icon:{},trend:{},progress:{},sparkline:{},variant:{default:"default"},size:{default:"standard"},subStat:{},className:{}},setup(l){const d={default:"bg-blue-50 text-[#1B4F72]",success:"bg-green-50 text-green-600",warning:"bg-amber-50 text-amber-600",danger:"bg-red-50 text-red-600"},b={up:"text-green-600 bg-green-50",down:"text-red-600 bg-red-50",neutral:"text-slate-600 bg-slate-100"},f={default:"[&>div]:bg-[#1B4F72]",success:"[&>div]:bg-green-500",warning:"[&>div]:bg-amber-500",danger:"[&>div]:bg-red-500"},v={default:"bg-blue-200",success:"bg-green-200",warning:"bg-amber-200",danger:"bg-red-200"};return($,h)=>(o(),g(t(C),{class:x(["hover:shadow-md transition-shadow",l.size==="standard"?"p-6":"p-4"])},{default:a(()=>[s(t(A),null,{default:a(()=>[n("div",ft,[n("div",{class:x(["p-2.5 rounded-lg",d[l.variant]])},[(o(),g(st(l.icon),{size:l.size==="standard"?20:16},null,8,["size"]))],2),l.trend?(o(),g(t(V),{key:0,variant:l.trend.direction==="up"?"default":l.trend.direction==="down"?"destructive":"secondary",class:x(b[l.trend.direction])},{default:a(()=>[l.trend.direction==="up"?(o(),g(t(L),{key:0,size:12,class:"mr-1"})):l.trend.direction==="down"?(o(),g(t(W),{key:1,size:12,class:"mr-1"})):(o(),g(t(q),{key:2,size:12,class:"mr-1"})),i(" "+m(l.trend.value),1)]),_:1},8,["variant","class"])):y("",!0)]),n("div",gt,[n("h3",{class:x(["font-medium text-slate-500",l.size==="standard"?"text-sm":"text-xs"])},m(l.label),3),n("div",{class:x(["font-bold text-slate-900",l.size==="standard"?"text-3xl":"text-2xl"])},m(l.value),3),l.trend?.label?(o(),c("p",xt,m(l.trend.label),1)):y("",!0),l.subStat?(o(),c("p",bt,m(l.subStat),1)):y("",!0)]),l.progress?(o(),c("div",vt,[n("div",ht,[n("span",null,m(l.progress.label||"Progress"),1),n("span",null,m(l.progress.current)+" / "+m(l.progress.total),1)]),s(t(E),{"model-value":l.progress.current/l.progress.total*100,class:x(f[l.variant])},null,8,["model-value","class"])])):y("",!0),l.sparkline&&l.sparkline.length>0?(o(),c("div",yt,[(o(!0),c(z,null,S(l.sparkline,(e,u)=>(o(),c("div",{key:u,class:x(["flex-1 rounded-t transition-all duration-300",v[l.variant]]),style:at({height:`${e/Math.max(...l.sparkline)*100}%`})},null,6))),128))])):y("",!0)]),_:1})]),_:1},8,["class"]))}}),B={getMetrics:l=>T.get(`/coordinator/organizations/${l}/dashboard/metrics`),getRecentCalls:(l,d=10)=>T.get(`/coordinator/organizations/${l}/dashboard/recent-calls`,{params:{limit:d}}),getTodayAppointments:l=>T.get(`/coordinator/organizations/${l}/dashboard/today-appointments`)},_t=lt("dashboard",()=>{const l=w(null),d=w([]),b=w([]),f=w(!1),v=w(null);async function $(){const e=N();if(!e.currentOrganization?.id)throw new Error("No organization selected");f.value=!0,v.value=null;try{const[u,r,M]=await Promise.all([B.getMetrics(e.currentOrganization.id),B.getRecentCalls(e.currentOrganization.id),B.getTodayAppointments(e.currentOrganization.id)]);l.value=u.data.data||u.data,d.value=r.data.data||r.data.data,b.value=M.data.data||M.data.data}catch(u){throw v.value=u.response?.data?.message||"Failed to load dashboard data",u}finally{f.value=!1}}async function h(){const e=N();if(e.currentOrganization?.id)try{const u=await B.getMetrics(e.currentOrganization.id);l.value=u.data.data||u.data}catch(u){console.error("Failed to refresh metrics:",u)}}return{metrics:l,recentCalls:d,todayAppointments:b,loading:f,error:v,fetchDashboardData:$,refreshMetrics:h}}),pt={class:"space-y-8"},wt={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},kt={key:0,class:"text-center py-12"},Ct={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700"},zt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"},$t={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},Ft={class:"lg:col-span-2 space-y-8"},Bt={class:"flex justify-between items-center mb-4"},At={key:0,class:"text-slate-500 text-center py-8"},St={key:1,class:"text-slate-500 text-center py-8"},Dt={key:2,class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},jt={class:"w-12 h-12 rounded-full bg-white border border-slate-200 flex items-center justify-center text-slate-400 group-hover:text-[#1B4F72] group-hover:border-[#1B4F72] mb-3 transition-colors shadow-sm"},Ot={class:"overflow-x-auto"},Tt={class:"space-y-8"},Nt={key:0,class:"text-slate-500 text-center py-8"},Mt={key:1,class:"relative pl-4 border-l-2 border-slate-100 space-y-8"},Rt={class:"flex flex-col"},Vt={class:"text-xs font-bold text-slate-400 mb-1"},Pt={class:"font-semibold text-slate-900"},Ut={class:"text-sm text-slate-500"},Et={class:"flex items-center gap-1 mt-1 text-xs text-slate-400"},Lt={class:"space-y-3"},ne=P({__name:"DashboardPage",setup(l){const d=_t(),b=ct(),f=N(),v=R(()=>b.coordinators.filter(h=>h.status==="active"||h.status==="activated")),$=R(()=>d.metrics?.new_contacts_this_week??0);return nt(async()=>{try{f.currentOrganization||(await f.fetchOrganizations(),f.organizations.length>0&&f.setCurrentOrganization(f.organizations[0])),f.currentOrganization?.id&&await Promise.all([d.fetchDashboardData(),b.fetchCoordinators()])}catch(h){console.error("Failed to load dashboard:",h)}}),(h,e)=>{const u=rt("router-link");return o(),g(U,null,{default:a(()=>[n("div",pt,[n("div",wt,[e[1]||(e[1]=n("div",null,[n("h1",{class:"text-3xl font-heading font-bold text-[#1B4F72]"}," Dashboard "),n("p",{class:"text-slate-500 mt-1"}," Welcome back! Here's what's happening with your 4 Calls. ")],-1)),s(t(_),{variant:"default",class:"bg-[#F59E0B] hover:bg-[#D97706] text-white","as-child":""},{default:a(()=>[s(u,{to:"/coordinators",class:"flex items-center gap-2"},{default:a(()=>[e[0]||(e[0]=i(" Manage 4 Calls ",-1)),s(t(H),{size:18})]),_:1})]),_:1})]),t(d).loading?(o(),c("div",kt,[...e[2]||(e[2]=[n("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-[#1B4F72]"},null,-1),n("p",{class:"mt-4 text-slate-500"},"Loading dashboard data...",-1)])])):t(d).error?(o(),c("div",Ct,m(t(d).error),1)):(o(),c(z,{key:2},[n("div",zt,[s(F,{label:"Calls Today",value:t(d).metrics?.calls_today||0,icon:t(I),trend:t(d).metrics?.calls_today_trend},null,8,["value","icon","trend"]),s(F,{label:"Appointments This Week",value:t(d).metrics?.appointments_this_week||0,icon:t(Q),trend:t(d).metrics?.appointments_trend},null,8,["value","icon","trend"]),s(F,{label:"Total Contacts",value:t(mt)(t(d).metrics?.total_contacts||0),icon:t(X),"sub-stat":`+${$.value} new this week`},null,8,["value","icon","sub-stat"]),s(F,{label:"No-Show Rate",value:`${t(d).metrics?.no_show_rate||0}%`,icon:t(Z),trend:t(d).metrics?.no_show_trend},null,8,["value","icon","trend"])]),n("div",$t,[n("div",Ft,[n("section",null,[n("div",Bt,[e[4]||(e[4]=n("h2",{class:"text-xl font-bold text-[#1B4F72]"}," Active 4 Calls ",-1)),s(u,{to:"/coordinators",class:"text-sm font-medium text-[#1B4F72] hover:underline"},{default:a(()=>[...e[3]||(e[3]=[i(" View All ",-1)])]),_:1})]),t(b).loading?(o(),c("div",At," Loading 4 Calls... ")):v.value.length===0?(o(),c("div",St,[e[6]||(e[6]=i(" No active 4 Calls. ",-1)),s(u,{to:"/coordinators",class:"text-[#1B4F72] hover:underline"},{default:a(()=>[...e[5]||(e[5]=[i("Add one",-1)])]),_:1}),e[7]||(e[7]=i(" to get started. ",-1))])):(o(),c("div",Dt,[(o(!0),c(z,null,S(v.value.slice(0,3),r=>(o(),g(ot,{key:r.id,id:r.id,name:r.display_name||r.role_template?.name||"4 Call",role:r.role_template?.name||"Unknown Role",status:r.status==="active"?"active":"paused",compact:!0,"compact-stats":"15 calls"},null,8,["id","name","role","status"]))),128)),s(t(C),{class:"border-2 border-dashed border-slate-300 hover:border-[#1B4F72] hover:bg-blue-50/50 transition-all duration-200 flex flex-col items-center justify-center p-6 group cursor-pointer h-full min-h-[200px] bg-slate-50","as-child":""},{default:a(()=>[s(u,{to:"/coordinators",class:"flex flex-col items-center justify-center w-full h-full"},{default:a(()=>[n("div",jt,[s(t(G),{size:24})]),e[8]||(e[8]=n("span",{class:"font-medium text-slate-600 group-hover:text-[#1B4F72]"}," Add 4 Call ",-1))]),_:1})]),_:1})]))]),s(t(C),{class:"overflow-hidden"},{default:a(()=>[s(t(D),{class:"flex flex-row items-center justify-between"},{default:a(()=>[s(t(j),{class:"text-xl font-bold text-[#1B4F72]"},{default:a(()=>[...e[9]||(e[9]=[i("Recent Calls",-1)])]),_:1}),s(t(_),{variant:"ghost",size:"sm","as-child":""},{default:a(()=>[s(u,{to:"/calls"},{default:a(()=>[...e[10]||(e[10]=[i("View All",-1)])]),_:1})]),_:1})]),_:1}),s(t(A),null,{default:a(()=>[n("div",Ot,[s(t(it),null,{default:a(()=>[s(t(dt),null,{default:a(()=>[s(t(O),null,{default:a(()=>[s(t(k),null,{default:a(()=>[...e[11]||(e[11]=[i("Time",-1)])]),_:1}),s(t(k),null,{default:a(()=>[...e[12]||(e[12]=[i("Contact",-1)])]),_:1}),s(t(k),null,{default:a(()=>[...e[13]||(e[13]=[i("4 Call",-1)])]),_:1}),s(t(k),null,{default:a(()=>[...e[14]||(e[14]=[i("Duration",-1)])]),_:1}),s(t(k),null,{default:a(()=>[...e[15]||(e[15]=[i("Outcome",-1)])]),_:1})]),_:1})]),_:1}),s(t(ut),null,{default:a(()=>[(o(!0),c(z,null,S(t(d).recentCalls,r=>(o(),g(t(O),{key:r.id,class:"hover:bg-slate-50 transition-colors cursor-pointer"},{default:a(()=>[s(t(p),{class:"text-slate-500"},{default:a(()=>[i(m(r.time),1)]),_:2},1024),s(t(p),{class:"font-medium text-slate-900"},{default:a(()=>[i(m(r.contact_name),1)]),_:2},1024),s(t(p),{class:"text-slate-600"},{default:a(()=>[i(m(r.coordinator_name),1)]),_:2},1024),s(t(p),{class:"text-slate-500 font-mono text-xs"},{default:a(()=>[i(m(r.duration),1)]),_:2},1024),s(t(p),null,{default:a(()=>[s(t(V),{variant:r.status==="success"?"default":r.status==="error"?"destructive":"secondary",class:x(r.status==="success"?"bg-green-50 text-green-700":r.status==="error"?"bg-red-50 text-red-700":"bg-slate-100 text-slate-600")},{default:a(()=>[i(m(r.outcome),1)]),_:2},1032,["variant","class"])]),_:2},1024)]),_:2},1024))),128)),t(d).recentCalls.length===0?(o(),g(t(O),{key:0},{default:a(()=>[s(t(p),{colspan:"5",class:"text-center text-slate-500 py-8"},{default:a(()=>[...e[16]||(e[16]=[i(" No recent calls ",-1)])]),_:1})]),_:1})):y("",!0)]),_:1})]),_:1})])]),_:1})]),_:1})]),n("div",Tt,[s(t(C),null,{default:a(()=>[s(t(D),{class:"flex flex-row items-center justify-between"},{default:a(()=>[s(t(j),{class:"text-xl font-bold text-[#1B4F72]"},{default:a(()=>[...e[17]||(e[17]=[i(" Today's Appointments ",-1)])]),_:1}),s(t(_),{variant:"ghost",size:"sm","as-child":""},{default:a(()=>[s(u,{to:"/appointments"},{default:a(()=>[...e[18]||(e[18]=[i("View Calendar",-1)])]),_:1})]),_:1})]),_:1}),s(t(A),null,{default:a(()=>[t(d).todayAppointments.length===0?(o(),c("div",Nt," No appointments today ")):(o(),c("div",Mt,[(o(!0),c(z,null,S(t(d).todayAppointments,r=>(o(),c("div",{key:r.id,class:"relative"},[n("div",{class:x(["absolute -left-[21px] top-1 w-3 h-3 rounded-full border-2 border-white shadow-sm",r.status==="confirmed"?"bg-green-500":r.status==="pending"?"bg-amber-500":"bg-red-500"])},null,2),n("div",Rt,[n("span",Vt,m(r.time),1),n("h4",Pt,m(r.contact_name),1),n("p",Ut,m(r.type),1),n("div",Et,[n("span",null,"via "+m(r.coordinator_name),1),r.status==="confirmed"?(o(),g(t(J),{key:0,size:12,class:"text-green-500 ml-1"})):y("",!0),r.status==="cancelled"?(o(),g(t(K),{key:1,size:12,class:"text-red-500 ml-1"})):y("",!0)])])]))),128))]))]),_:1})]),_:1}),s(t(C),null,{default:a(()=>[s(t(D),null,{default:a(()=>[s(t(j),{class:"text-xl font-bold text-[#1B4F72]"},{default:a(()=>[...e[19]||(e[19]=[i(" Quick Actions ",-1)])]),_:1})]),_:1}),s(t(A),null,{default:a(()=>[n("div",Lt,[s(t(_),{variant:"outline",class:"w-full justify-start h-auto p-3"},{default:a(()=>[s(t(Y),{size:18,class:"mr-3"}),e[20]||(e[20]=i(" Import Contacts ",-1))]),_:1}),s(t(_),{variant:"outline",class:"w-full justify-start h-auto p-3"},{default:a(()=>[s(t(tt),{size:18,class:"mr-3"}),e[21]||(e[21]=i(" Create Campaign ",-1))]),_:1}),s(t(_),{variant:"outline",class:"w-full justify-start h-auto p-3"},{default:a(()=>[s(t(et),{size:18,class:"mr-3"}),e[22]||(e[22]=i(" View Analytics ",-1))]),_:1})])]),_:1})]),_:1})])])],64))])]),_:1})}}});export{ne as default};
