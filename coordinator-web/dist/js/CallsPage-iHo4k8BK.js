import{a as D,r as B,N as we,O as $,u as e,b as m,f as d,w as t,Q as P,o as fe,s,q as A,Z as ce,_ as pe,m as T,n as j,c as De,p as o,v as y,y as g,F as J,x as W,X as $e,B as ne,a2 as ie,A as U}from"./vue-vendor-BFreJ1An.js";import{a as ke,c as Oe,b as E,P as te,g as se,m as Be,_ as k,k as z,j as I,l as Y,h as X}from"./index-CMI_8iS_.js";import{u as re,g as ue,D as Fe,k as ze,F as Pe,l as oe,c as qe,P as me,b as Ae,T as Ie,d as ge,_ as Se,j as Ee}from"./Separator.vue_vue_type_script_setup_true_lang-UpEJj3Ga.js";import{a as Me,b as Z,c as S,d as Re,e as q,_ as Te}from"./TableHeader.vue_vue_type_script_setup_true_lang-BAK7VMpj.js";import{_ as je}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-CfYC6v2a.js";import{r as ve,_ as G}from"./index-YgZVUsNe.js";import{X as Ve,c as ee,f as _e,a7 as xe,j as Ne,P as be,ak as Le,e as Ue,v as Ke,a9 as He,aa as de,al as Qe,am as Xe,an as Ze,ab as Ge,ah as Je,ai as We}from"./ui-vendor-DelVp1tp.js";import{u as Ye}from"./calls-DX-k_dpT.js";import{useOrganizationsStore as et}from"./organizations-BeLDuyV9.js";import{c as tt,d as st,e as ot}from"./format-DaYpM1Fu.js";import{a as at}from"./status-DdzIA5VN.js";import{b as lt,g as nt,c as it,a as rt}from"./contact-MrFpTDs4.js";import{c as ut}from"./request-t1OiQL2I.js";import"./index-BsTtUH7V.js";import"./utils-vendor-B9ygI19o.js";const[M,dt]=Oe("DialogRoot");var ft=D({inheritAttrs:!1,__name:"DialogRoot",props:{open:{type:Boolean,required:!1,default:void 0},defaultOpen:{type:Boolean,required:!1,default:!1},modal:{type:Boolean,required:!1,default:!0}},emits:["update:open"],setup(n,{emit:l}){const r=n,i=ke(r,"open",l,{defaultValue:r.defaultOpen,passive:r.open===void 0}),C=B(),w=B(),{modal:x}=we(r);return dt({open:i,modal:x,openModal:()=>{i.value=!0},onOpenChange:v=>{i.value=v},onOpenToggle:()=>{i.value=!i.value},contentId:"",titleId:"",descriptionId:"",triggerElement:C,contentElement:w}),(v,p)=>$(v.$slots,"default",{open:e(i),close:()=>i.value=!1})}}),ct=ft,pt=D({__name:"DialogClose",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(n){const l=n;E();const r=M();return(u,i)=>(d(),m(e(te),P(l,{type:u.as==="button"?"button":void 0,onClick:i[0]||(i[0]=C=>e(r).onOpenChange(!1))}),{default:t(()=>[$(u.$slots,"default")]),_:3},16,["type"]))}}),mt=pt,gt=D({__name:"DialogContentImpl",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(n,{emit:l}){const r=n,u=l,i=M(),{forwardRef:C,currentElement:w}=E();return i.titleId||=re(void 0,"reka-dialog-title"),i.descriptionId||=re(void 0,"reka-dialog-description"),fe(()=>{i.contentElement=w,ue()!==document.body&&(i.triggerElement.value=ue())}),(x,v)=>(d(),m(e(Pe),{"as-child":"",loop:"",trapped:r.trapFocus,onMountAutoFocus:v[5]||(v[5]=p=>u("openAutoFocus",p)),onUnmountAutoFocus:v[6]||(v[6]=p=>u("closeAutoFocus",p))},{default:t(()=>[s(e(Fe),P({id:e(i).contentId,ref:e(C),as:x.as,"as-child":x.asChild,"disable-outside-pointer-events":x.disableOutsidePointerEvents,role:"dialog","aria-describedby":e(i).descriptionId,"aria-labelledby":e(i).titleId,"data-state":e(ze)(e(i).open.value)},x.$attrs,{onDismiss:v[0]||(v[0]=p=>e(i).onOpenChange(!1)),onEscapeKeyDown:v[1]||(v[1]=p=>u("escapeKeyDown",p)),onFocusOutside:v[2]||(v[2]=p=>u("focusOutside",p)),onInteractOutside:v[3]||(v[3]=p=>u("interactOutside",p)),onPointerDownOutside:v[4]||(v[4]=p=>u("pointerDownOutside",p))}),{default:t(()=>[$(x.$slots,"default")]),_:3},16,["id","as","as-child","disable-outside-pointer-events","aria-describedby","aria-labelledby","data-state"])]),_:3},8,["trapped"]))}}),ye=gt,vt=D({__name:"DialogContentModal",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(n,{emit:l}){const r=n,u=l,i=M(),C=oe(u),{forwardRef:w,currentElement:x}=E();return qe(x),(v,p)=>(d(),m(ye,P({...r,...e(C)},{ref:e(w),"trap-focus":e(i).open.value,"disable-outside-pointer-events":!0,onCloseAutoFocus:p[0]||(p[0]=h=>{h.defaultPrevented||(h.preventDefault(),e(i).triggerElement.value?.focus())}),onPointerDownOutside:p[1]||(p[1]=h=>{const O=h.detail.originalEvent,R=O.button===0&&O.ctrlKey===!0;(O.button===2||R)&&h.preventDefault()}),onFocusOutside:p[2]||(p[2]=h=>{h.preventDefault()})}),{default:t(()=>[$(v.$slots,"default")]),_:3},16,["trap-focus"]))}}),_t=vt,xt=D({__name:"DialogContentNonModal",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(n,{emit:l}){const r=n,i=oe(l);E();const C=M(),w=B(!1),x=B(!1);return(v,p)=>(d(),m(ye,P({...r,...e(i)},{"trap-focus":!1,"disable-outside-pointer-events":!1,onCloseAutoFocus:p[0]||(p[0]=h=>{h.defaultPrevented||(w.value||e(C).triggerElement.value?.focus(),h.preventDefault()),w.value=!1,x.value=!1}),onInteractOutside:p[1]||(p[1]=h=>{h.defaultPrevented||(w.value=!0,h.detail.originalEvent.type==="pointerdown"&&(x.value=!0));const O=h.target;e(C).triggerElement.value?.contains(O)&&h.preventDefault(),h.detail.originalEvent.type==="focusin"&&x.value&&h.preventDefault()})}),{default:t(()=>[$(v.$slots,"default")]),_:3},16))}}),bt=xt,yt=D({__name:"DialogContent",props:{forceMount:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(n,{emit:l}){const r=n,u=l,i=M(),C=oe(u),{forwardRef:w}=E();return(x,v)=>(d(),m(e(me),{present:x.forceMount||e(i).open.value},{default:t(()=>[e(i).modal.value?(d(),m(_t,P({key:0,ref:e(w)},{...r,...e(C),...x.$attrs}),{default:t(()=>[$(x.$slots,"default")]),_:3},16)):(d(),m(bt,P({key:1,ref:e(w)},{...r,...e(C),...x.$attrs}),{default:t(()=>[$(x.$slots,"default")]),_:3},16))]),_:3},8,["present"]))}}),Ct=yt,ht=D({__name:"DialogOverlayImpl",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(n){const l=M();return Ae(!0),E(),(r,u)=>(d(),m(e(te),{as:r.as,"as-child":r.asChild,"data-state":e(l).open.value?"open":"closed",style:{"pointer-events":"auto"}},{default:t(()=>[$(r.$slots,"default")]),_:3},8,["as","as-child","data-state"]))}}),wt=ht,Dt=D({__name:"DialogOverlay",props:{forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(n){const l=M(),{forwardRef:r}=E();return(u,i)=>e(l)?.modal.value?(d(),m(e(me),{key:0,present:u.forceMount||e(l).open.value},{default:t(()=>[s(wt,P(u.$attrs,{ref:e(r),as:u.as,"as-child":u.asChild}),{default:t(()=>[$(u.$slots,"default")]),_:3},16,["as","as-child"])]),_:3},8,["present"])):A("v-if",!0)}}),$t=Dt,kt=D({__name:"DialogPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(n){const l=n;return(r,u)=>(d(),m(e(Ie),ce(pe(l)),{default:t(()=>[$(r.$slots,"default")]),_:3},16))}}),Ot=kt,Bt=D({__name:"DialogTitle",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"h2"}},setup(n){const l=n,r=M();return E(),(u,i)=>(d(),m(e(te),P(l,{id:e(r).titleId}),{default:t(()=>[$(u.$slots,"default")]),_:3},16,["id"]))}}),Ft=Bt;const zt=D({__name:"Sheet",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(n,{emit:l}){const i=ge(n,l);return(C,w)=>(d(),m(e(ct),ce(pe(e(i))),{default:t(()=>[$(C.$slots,"default")]),_:3},16))}}),Pt=D({inheritAttrs:!1,__name:"SheetContent",props:{class:{},side:{},forceMount:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(n,{emit:l}){const r=n,u=l,i=ve(r,"class","side"),C=ge(i,u);return(w,x)=>(d(),m(e(Ot),null,{default:t(()=>[s(e($t),{class:"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),s(e(Ct),P({class:e(se)(e(It)({side:n.side}),r.class)},{...e(C),...w.$attrs}),{default:t(()=>[$(w.$slots,"default"),s(e(mt),{class:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary"},{default:t(()=>[s(e(Ve),{class:"w-4 h-4 text-muted-foreground"})]),_:1})]),_:3},16,["class"])]),_:3}))}}),qt=D({__name:"SheetHeader",props:{class:{}},setup(n){const l=n;return(r,u)=>(d(),T("div",{class:j(e(se)("flex flex-col gap-y-2 text-center sm:text-left",l.class))},[$(r.$slots,"default")],2))}}),At=D({__name:"SheetTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,r=ve(l,"class");return(u,i)=>(d(),m(e(Ft),P({class:e(se)("text-lg font-semibold text-foreground",l.class)},e(r)),{default:t(()=>[$(u.$slots,"default")]),_:3},16,["class"]))}}),It=Be("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),St={class:"flex justify-between items-start"},Et={class:"flex items-center gap-2 text-sm text-slate-500 mt-1"},Mt={class:"flex gap-2"},Rt={key:0,class:"space-y-8"},Tt={class:"flex items-center gap-3"},jt={class:"w-10 h-10 rounded-full bg-slate-200 flex items-center justify-center text-slate-500"},Vt={class:"font-bold text-slate-900"},Nt={class:"text-xs text-slate-500"},Lt={class:"flex items-center gap-3 text-right"},Ut={class:"font-bold text-slate-900"},Kt={class:"w-10 h-10 rounded-full bg-blue-100 text-[#1B4F72] flex items-center justify-center font-bold"},Ht={class:"flex justify-center"},Qt={class:"flex items-center justify-between"},Xt={class:"flex gap-2 text-xs font-medium text-slate-500"},Zt={class:"h-12 flex items-center gap-0.5 mb-4 px-2"},Gt={class:"flex items-center gap-4"},Jt={class:"flex-1"},Wt={class:"flex justify-between text-xs text-slate-500 mt-1"},Yt={class:"space-y-3 text-sm text-slate-700"},es={class:"font-semibold text-xs text-slate-500 mb-1"},ts={class:"text-sm text-slate-700"},ss=D({__name:"CallDetailPanel",props:{call:{},isOpen:{type:Boolean}},emits:["close"],setup(n,{emit:l}){const r=n,u=l,i=B(!1);function C(_){_||u("close")}const w=De(()=>r.call?.transcript?[{speaker:"coordinator",text:"Hello, thank you for calling..."},{speaker:"customer",text:"Hi, I need to schedule an appointment..."}]:[]);function x(_){return _?new Date(_).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""}function v(_){return _?new Date(_).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):""}function p(_){const f=Math.floor(_/60),F=_%60;return`${f}:${F.toString().padStart(2,"0")}`}function h(_){if(_.contact){const f=_.contact;return`${f.first_name} ${f.last_name||""}`.trim()||"Unknown"}return"Unknown"}function O(_){return _.coordinator?_.coordinator.display_name||"Coordinator":"Unknown"}function R(_){return O(_).charAt(0).toUpperCase()}function N(_){if(!_)return"bg-slate-50 text-slate-600 border-slate-200";const f=_.toLowerCase();return f.includes("booked")||f.includes("confirmed")?"bg-green-50 text-green-700 border-green-200":f.includes("info")?"bg-blue-50 text-blue-700 border-blue-200":f.includes("transferred")?"bg-amber-50 text-amber-700 border-amber-200":"bg-slate-50 text-slate-600 border-slate-200"}function K(){i.value=!i.value}function V(){r.call?.recording_url&&window.open(r.call.recording_url,"_blank")}return(_,f)=>(d(),m(e(zt),{open:n.isOpen,"onUpdate:open":C},{default:t(()=>[s(e(Pt),{side:"right",class:"w-full sm:w-[500px] overflow-y-auto"},{default:t(()=>[s(e(qt),{class:"sticky top-0 bg-white border-b border-slate-100 p-6 -mx-6 -mt-6 mb-6 z-10"},{default:t(()=>[o("div",St,[o("div",null,[s(e(At),{class:"text-xl font-bold text-slate-900"},{default:t(()=>[...f[0]||(f[0]=[y("Call Details",-1)])]),_:1}),o("div",Et,[s(e(ee),{size:14}),o("span",null,g(x(n.call?.started_at))+" at "+g(v(n.call?.started_at)),1),f[1]||(f[1]=o("span",null,"â€¢",-1)),s(e(_e),{size:14}),o("span",null,g(p(n.call?.duration_seconds||0)),1)])]),o("div",Mt,[n.call?.recording_url?(d(),m(e(k),{key:0,variant:"ghost",size:"icon",onClick:V,class:"text-slate-400 hover:text-slate-600"},{default:t(()=>[s(e(xe),{size:20})]),_:1})):A("",!0)])])]),_:1}),n.call?(d(),T("div",Rt,[s(e(z),{class:"bg-slate-50"},{default:t(()=>[s(e(I),{class:"p-4 flex justify-between items-center"},{default:t(()=>[o("div",Tt,[o("div",jt,[s(e(Ne),{size:20})]),o("div",null,[o("div",Vt,g(h(n.call)),1),o("div",Nt,g(n.call.from_number),1)])]),s(e(Se),{orientation:"vertical",class:"h-8"}),o("div",Lt,[o("div",null,[o("div",Ut,g(O(n.call)),1),f[2]||(f[2]=o("div",{class:"text-xs text-slate-500"},"Coordinator",-1))]),o("div",Kt,g(R(n.call)),1)])]),_:1})]),_:1}),o("div",Ht,[s(e(Y),{class:j(N(n.call.outcome))},{default:t(()=>[y(g(n.call.outcome||"Completed"),1)]),_:1},8,["class"])]),n.call.recording_url?(d(),m(e(z),{key:0},{default:t(()=>[s(e(X),null,{default:t(()=>[o("div",Qt,[s(e(G),{class:"text-sm font-bold text-slate-900"},{default:t(()=>[...f[3]||(f[3]=[y("Recording",-1)])]),_:1}),o("div",Xt,[s(e(k),{variant:"ghost",size:"sm",class:"h-auto p-0 text-xs hover:text-[#1B4F72]"},{default:t(()=>[...f[4]||(f[4]=[y("1x",-1)])]),_:1}),s(e(k),{variant:"ghost",size:"sm",class:"h-auto p-0 text-xs hover:text-[#1B4F72]"},{default:t(()=>[...f[5]||(f[5]=[y("1.5x",-1)])]),_:1}),s(e(k),{variant:"ghost",size:"sm",class:"h-auto p-0 text-xs hover:text-[#1B4F72]"},{default:t(()=>[...f[6]||(f[6]=[y("2x",-1)])]),_:1})])])]),_:1}),s(e(I),null,{default:t(()=>[o("div",Zt,[(d(),T(J,null,W(40,F=>o("div",{key:F,class:j(["w-1.5 rounded-full transition-all",F<15?"bg-[#1B4F72]":"bg-slate-200"]),style:$e({height:`${Math.max(20,Math.random()*100)}%`})},null,6)),64))]),o("div",Gt,[s(e(k),{onClick:K,size:"icon",class:"w-10 h-10 rounded-full bg-[#1B4F72] hover:bg-[#153e5a]"},{default:t(()=>[i.value?(d(),m(e(Le),{key:1,size:18})):(d(),m(e(be),{key:0,size:18,fill:"currentColor",class:"ml-0.5"}))]),_:1}),o("div",Jt,[f[8]||(f[8]=o("div",{class:"h-1 bg-slate-200 rounded-full overflow-hidden"},[o("div",{class:"h-full bg-[#1B4F72] rounded-full",style:{width:"35%"}})],-1)),o("div",Wt,[f[7]||(f[7]=o("span",null,"0:45",-1)),o("span",null,g(p(n.call.duration_seconds)),1)])])])]),_:1})]),_:1})):A("",!0),n.call.transcript?(d(),m(e(z),{key:1},{default:t(()=>[s(e(X),null,{default:t(()=>[s(e(G),{class:"text-sm font-bold text-slate-900"},{default:t(()=>[...f[9]||(f[9]=[y("Transcript",-1)])]),_:1})]),_:1}),s(e(I),null,{default:t(()=>[o("div",Yt,[(d(!0),T(J,null,W(w.value,(F,H)=>(d(),m(e(z),{key:H,class:j(F.speaker==="coordinator"?"bg-blue-50":"bg-slate-50")},{default:t(()=>[s(e(I),{class:"p-3"},{default:t(()=>[o("div",es,g(F.speaker==="coordinator"?O(n.call):h(n.call)),1),o("div",null,g(F.text),1)]),_:2},1024)]),_:2},1032,["class"]))),128))])]),_:1})]),_:1})):A("",!0),n.call.ai_summary?(d(),m(e(z),{key:2},{default:t(()=>[s(e(X),null,{default:t(()=>[s(e(G),{class:"text-sm font-bold text-slate-900 flex items-center gap-2"},{default:t(()=>[s(e(Ue),{size:16,class:"text-amber-500"}),f[10]||(f[10]=y(" AI Summary ",-1))]),_:1})]),_:1}),s(e(I),null,{default:t(()=>[o("p",ts,g(n.call.ai_summary),1)]),_:1})]),_:1})):A("",!0)])):A("",!0)]),_:1})]),_:1},8,["open"]))}}),os={class:"space-y-6"},as={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},ls={class:"text-slate-500 mt-1"},ns={class:"flex gap-3"},is={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},rs={class:"p-3 bg-blue-50 text-[#1B4F72] rounded-lg"},us={class:"text-2xl font-bold text-slate-900"},ds={class:"p-3 bg-amber-50 text-amber-600 rounded-lg"},fs={class:"text-2xl font-bold text-slate-900"},cs={class:"p-3 bg-green-50 text-green-600 rounded-lg"},ps={class:"text-2xl font-bold text-slate-900"},ms={class:"relative"},gs={class:"flex flex-wrap gap-3 items-center"},vs={class:"relative"},_s={class:"relative"},xs={key:0,class:"text-center py-12"},bs={class:"overflow-x-auto"},ys={class:"font-medium text-slate-900"},Cs={class:"text-xs"},hs={class:"flex items-center gap-2"},ws={class:"w-6 h-6 rounded-full bg-slate-100 flex items-center justify-center text-xs font-bold text-slate-500"},Ds={class:"flex items-center gap-2"},$s={class:"w-6 h-6 rounded-full bg-blue-50 text-[#1B4F72] flex items-center justify-center text-[10px] font-bold"},ks={class:"text-sm text-slate-600"},Os={class:"flex items-center justify-end gap-2"},Bs={class:"px-6 py-4 border-t border-slate-200 flex items-center justify-between"},Fs={class:"text-sm text-slate-500"},zs={class:"flex gap-2"},Hs=D({__name:"CallsPage",setup(n){const l=Ye(),r=et(),u=B(""),i=B(""),C=B(""),w=B(!1),x=ot,v=tt,p=at,h=b=>nt(b),O=b=>lt(b),R=b=>rt(b),N=b=>it(b);function K(b){if(!b)return"secondary";const a=b.toLowerCase();return a.includes("booked")||a.includes("confirmed")?"default":a.includes("spam")||a.includes("blocked")?"destructive":"secondary"}const V=B(null),_=B(!1);function f(b){V.value=b,_.value=!0}function F(b){b.recording_url&&window.open(b.recording_url,"_blank")}function H(b){V.value=b,_.value=!0}const Ce=ut(()=>{L()},300);function ae(){L()}function le(b){L({page:b})}function he(){}async function L(b){try{await Promise.all([l.fetchCalls({search:u.value||void 0,direction:i.value||void 0,outcome:C.value||void 0,...b}),l.fetchStats({direction:i.value&&(i.value==="inbound"||i.value==="outbound")?i.value:void 0,outcome:C.value||void 0})])}catch(a){console.error("Failed to fetch calls:",a)}}return fe(async()=>{try{r.currentOrganization||(await r.fetchOrganizations(),r.organizations.length>0&&r.setCurrentOrganization(r.organizations[0])),r.currentOrganization?.id&&await L()}catch(b){console.error("Failed to load calls:",b)}}),(b,a)=>(d(),m(je,null,{default:t(()=>[o("div",os,[o("div",as,[o("div",null,[a[8]||(a[8]=o("h1",{class:"text-3xl font-heading font-bold text-[#1B4F72]"}," Call History ",-1)),o("p",ls,g(e(l).total)+" total calls",1)]),o("div",ns,[s(e(k),{variant:"outline",onClick:a[0]||(a[0]=c=>w.value=!w.value)},{default:t(()=>[s(e(ee),{size:18,class:"mr-2"}),a[9]||(a[9]=y(" Last 30 Days ",-1))]),_:1}),s(e(k),{variant:"outline",onClick:he},{default:t(()=>[s(e(xe),{size:18,class:"mr-2"}),a[10]||(a[10]=y(" Export ",-1))]),_:1})])]),o("div",is,[s(e(z),null,{default:t(()=>[s(e(I),{class:"p-4 flex items-center gap-4"},{default:t(()=>[o("div",rs,[s(e(Ke),{size:24})]),o("div",null,[o("div",us,g(e(l).stats?.calls_today||0),1),a[11]||(a[11]=o("div",{class:"text-sm text-slate-500"},"Calls Today",-1))])]),_:1})]),_:1}),s(e(z),null,{default:t(()=>[s(e(I),{class:"p-4 flex items-center gap-4"},{default:t(()=>[o("div",ds,[s(e(_e),{size:24})]),o("div",null,[o("div",fs,g(e(v)(e(l).stats?.avg_duration||0)),1),a[12]||(a[12]=o("div",{class:"text-sm text-slate-500"},"Avg Duration",-1))])]),_:1})]),_:1}),s(e(z),null,{default:t(()=>[s(e(I),{class:"p-4 flex items-center gap-4"},{default:t(()=>[o("div",cs,[s(e(ee),{size:24})]),o("div",null,[o("div",ps,g(e(l).stats?.booking_rate||0)+"% ",1),a[13]||(a[13]=o("div",{class:"text-sm text-slate-500"},"Booking Rate",-1))])]),_:1})]),_:1})]),s(e(z),null,{default:t(()=>[s(e(I),{class:"p-4 space-y-4"},{default:t(()=>[o("div",ms,[s(e(He),{class:"absolute left-3 top-3 text-slate-400",size:20}),s(e(Ee),{modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=c=>u.value=c),type:"text",placeholder:"Search by contact name or phone...",class:"pl-10",onInput:e(Ce)},null,8,["modelValue","onInput"])]),o("div",gs,[o("div",vs,[ne(o("select",{"onUpdate:modelValue":a[2]||(a[2]=c=>i.value=c),class:"appearance-none pl-3 pr-8 py-1.5 rounded-lg border border-slate-200 bg-white text-sm font-medium text-slate-700 focus:outline-none focus:ring-2 focus:ring-[#1B4F72]/20 focus:border-[#1B4F72] cursor-pointer hover:bg-slate-50",onChange:ae},[...a[14]||(a[14]=[o("option",{value:""},"Direction: All",-1),o("option",{value:"inbound"},"Inbound",-1),o("option",{value:"outbound"},"Outbound",-1)])],544),[[ie,i.value]]),s(e(de),{class:"absolute right-2.5 top-2 text-slate-400 pointer-events-none",size:12})]),o("div",_s,[ne(o("select",{"onUpdate:modelValue":a[3]||(a[3]=c=>C.value=c),class:"appearance-none pl-3 pr-8 py-1.5 rounded-lg border border-slate-200 bg-white text-sm font-medium text-slate-700 focus:outline-none focus:ring-2 focus:ring-[#1B4F72]/20 focus:border-[#1B4F72] cursor-pointer hover:bg-slate-50",onChange:ae},[...a[15]||(a[15]=[o("option",{value:""},"Outcome: All",-1),o("option",{value:"booked"},"Appointment Booked",-1),o("option",{value:"confirmed"},"Confirmed",-1),o("option",{value:"info"},"Info Only",-1)])],544),[[ie,C.value]]),s(e(de),{class:"absolute right-2.5 top-2 text-slate-400 pointer-events-none",size:12})])])]),_:1})]),_:1}),e(l).loading?(d(),T("div",xs,[...a[16]||(a[16]=[o("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-[#1B4F72]"},null,-1),o("p",{class:"mt-4 text-slate-500"},"Loading calls...",-1)])])):(d(),m(e(z),{key:1,class:"overflow-hidden"},{default:t(()=>[o("div",bs,[s(e(Te),null,{default:t(()=>[s(e(Me),null,{default:t(()=>[s(e(Z),null,{default:t(()=>[s(e(S),null,{default:t(()=>[...a[17]||(a[17]=[y("Date/Time",-1)])]),_:1}),s(e(S),null,{default:t(()=>[...a[18]||(a[18]=[y("Contact",-1)])]),_:1}),s(e(S),null,{default:t(()=>[...a[19]||(a[19]=[y("Phone",-1)])]),_:1}),s(e(S),null,{default:t(()=>[...a[20]||(a[20]=[y("Coordinator",-1)])]),_:1}),s(e(S),null,{default:t(()=>[...a[21]||(a[21]=[y("Direction",-1)])]),_:1}),s(e(S),null,{default:t(()=>[...a[22]||(a[22]=[y("Duration",-1)])]),_:1}),s(e(S),null,{default:t(()=>[...a[23]||(a[23]=[y("Outcome",-1)])]),_:1}),s(e(S),{class:"text-right"},{default:t(()=>[...a[24]||(a[24]=[y("Actions",-1)])]),_:1})]),_:1})]),_:1}),s(e(Re),null,{default:t(()=>[(d(!0),T(J,null,W(e(l).calls,c=>(d(),m(e(Z),{key:c.id,class:"hover:bg-slate-50 transition-colors cursor-pointer",onClick:Q=>f(c)},{default:t(()=>[s(e(q),{class:"text-slate-500"},{default:t(()=>[o("div",ys,g(e(st)(c.started_at)),1),o("div",Cs,g(e(x)(c.started_at)),1)]),_:2},1024),s(e(q),{class:"font-medium text-slate-900"},{default:t(()=>[o("div",hs,[o("div",ws,g(O(c)),1),y(" "+g(h(c)),1)])]),_:2},1024),s(e(q),{class:"text-slate-500 font-mono text-xs"},{default:t(()=>[y(g(c.from_number),1)]),_:2},1024),s(e(q),null,{default:t(()=>[o("div",Ds,[o("div",$s,g(N(c)),1),o("span",ks,g(R(c)),1)])]),_:2},1024),s(e(q),null,{default:t(()=>[s(e(Y),{variant:c.direction==="inbound"?"default":"secondary",class:j(c.direction==="inbound"?"bg-blue-50 text-blue-700":"bg-purple-50 text-purple-700")},{default:t(()=>[c.direction==="inbound"?(d(),m(e(Qe),{key:0,size:12,class:"mr-1"})):(d(),m(e(Xe),{key:1,size:12,class:"mr-1"})),y(" "+g(c.direction==="inbound"?"Inbound":"Outbound"),1)]),_:2},1032,["variant","class"])]),_:2},1024),s(e(q),{class:"text-slate-500 font-mono text-xs"},{default:t(()=>[y(g(e(v)(c.duration_seconds)),1)]),_:2},1024),s(e(q),null,{default:t(()=>[s(e(Y),{variant:K(c.outcome??null),class:j(e(p)(c.outcome))},{default:t(()=>[y(g(c.outcome||"Completed"),1)]),_:2},1032,["variant","class"])]),_:2},1024),s(e(q),{class:"text-right",onClick:a[4]||(a[4]=U(()=>{},["stop"]))},{default:t(()=>[o("div",Os,[c.recording_url?(d(),m(e(k),{key:0,variant:"ghost",size:"sm",onClick:U(Q=>F(c),["stop"]),title:"Play Recording"},{default:t(()=>[s(e(be),{size:16})]),_:1},8,["onClick"])):A("",!0),c.transcript?(d(),m(e(k),{key:1,variant:"ghost",size:"sm",onClick:U(Q=>H(c),["stop"]),title:"View Transcript"},{default:t(()=>[s(e(Ze),{size:16})]),_:1},8,["onClick"])):A("",!0),s(e(k),{variant:"ghost",size:"sm",onClick:U(Q=>f(c),["stop"])},{default:t(()=>[s(e(Ge),{size:16})]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1032,["onClick"]))),128)),e(l).calls.length===0?(d(),m(e(Z),{key:0},{default:t(()=>[s(e(q),{colspan:"8",class:"text-center text-slate-500 py-8"},{default:t(()=>[...a[25]||(a[25]=[y(" No calls found ",-1)])]),_:1})]),_:1})):A("",!0)]),_:1})]),_:1})]),o("div",Bs,[o("span",Fs," Showing "+g((e(l).page-1)*e(l).perPage+1)+"- "+g(Math.min(e(l).page*e(l).perPage,e(l).total))+" of "+g(e(l).total),1),o("div",zs,[s(e(k),{variant:"outline",size:"sm",disabled:e(l).page===1,onClick:a[5]||(a[5]=c=>le(e(l).page-1))},{default:t(()=>[s(e(Je),{size:16})]),_:1},8,["disabled"]),s(e(k),{variant:"outline",size:"sm",disabled:e(l).page*e(l).perPage>=e(l).total,onClick:a[6]||(a[6]=c=>le(e(l).page+1))},{default:t(()=>[s(e(We),{size:16})]),_:1},8,["disabled"])])])]),_:1}))]),s(ss,{call:V.value,"is-open":_.value,onClose:a[7]||(a[7]=c=>_.value=!1)},null,8,["call","is-open"])]),_:1}))}});export{Hs as default};
