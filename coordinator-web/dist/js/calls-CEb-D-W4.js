import{d as w,r as o}from"./vue-vendor-lZgBCM-Y.js";import{a as u}from"./index-C8fGv0Lo.js";import{useOrganizationsStore as g}from"./organizations-CvdzM5JO.js";const d={getHistory:(t,e)=>u.get(`/coordinator/organizations/${t}/calls`,{params:e}),getById:(t,e)=>u.get(`/coordinator/organizations/${t}/calls/${e}`),getStats:(t,e)=>u.get(`/coordinator/organizations/${t}/calls/stats`,{params:e})},C=w("calls",()=>{const t=o([]),e=o(null),s=o(!1),l=o(null),p=o(0),i=o(1),c=o(15),f=o(null);async function z(n){const r=g();if(!r.currentOrganization?.id)throw new Error("No organization selected");s.value=!0,l.value=null;try{const a=await d.getHistory(r.currentOrganization.id,{...n,page:n?.page||i.value,per_page:n?.per_page||c.value});t.value=a.data.data,p.value=a.data.total,i.value=a.data.page,c.value=a.data.per_page}catch(a){throw l.value=a.response?.data?.message||"Failed to load calls",a}finally{s.value=!1}}async function y(n){const r=g();if(!r.currentOrganization?.id)throw new Error("No organization selected");s.value=!0,l.value=null;try{const a=await d.getById(r.currentOrganization.id,n),v=a.data.data||a.data;return e.value=v,v}catch(a){throw l.value=a.response?.data?.message||"Failed to load call",a}finally{s.value=!1}}async function h(n){const r=g();if(!r.currentOrganization?.id)throw new Error("No organization selected");try{const a=await d.getStats(r.currentOrganization.id,n);f.value=a.data}catch(a){console.error("Failed to load call stats:",a)}}return{calls:t,currentCall:e,loading:s,error:l,total:p,page:i,perPage:c,stats:f,fetchCalls:z,fetchCall:y,fetchStats:h}});export{C as u};
