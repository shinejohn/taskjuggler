import{d as h,r as o}from"./vue-vendor-BFreJ1An.js";import{a as u}from"./index-BsTtUH7V.js";import{useOrganizationsStore as g}from"./organizations-BeLDuyV9.js";const d={getHistory:(t,e)=>u.get(`/coordinator/organizations/${t}/calls`,{params:e}),getById:(t,e)=>u.get(`/coordinator/organizations/${t}/calls/${e}`),getStats:(t,e)=>u.get(`/coordinator/organizations/${t}/calls/stats`,{params:e})},O=h("calls",()=>{const t=o([]),e=o(null),l=o(!1),s=o(null),p=o(0),i=o(1),c=o(15),f=o(null);async function v(n){const r=g();if(!r.currentOrganization?.id)throw new Error("No organization selected");l.value=!0,s.value=null;try{const a=await d.getHistory(r.currentOrganization.id,{...n,page:n?.page||i.value,per_page:n?.per_page||c.value});t.value=a.data.data,p.value=a.data.total,i.value=a.data.page,c.value=a.data.per_page}catch(a){throw s.value=a.response?.data?.message||"Failed to load calls",a}finally{l.value=!1}}async function z(n){const r=g();if(!r.currentOrganization?.id)throw new Error("No organization selected");l.value=!0,s.value=null;try{const a=await d.getById(r.currentOrganization.id,n);return e.value=a.data,a.data}catch(a){throw s.value=a.response?.data?.message||"Failed to load call",a}finally{l.value=!1}}async function y(n){const r=g();if(!r.currentOrganization?.id)throw new Error("No organization selected");try{const a=await d.getStats(r.currentOrganization.id,n);f.value=a.data}catch(a){console.error("Failed to load call stats:",a)}}return{calls:t,currentCall:e,loading:l,error:s,total:p,page:i,perPage:c,stats:f,fetchCalls:v,fetchCall:z,fetchStats:y}});export{O as u};
