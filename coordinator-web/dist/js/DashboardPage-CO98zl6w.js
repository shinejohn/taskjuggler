import{_ as U}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-CfYC6v2a.js";import{k as C,j as A,l as R,_,h as j}from"./index-CMI_8iS_.js";import{_ as E}from"./Progress.vue_vue_type_script_setup_true_lang-CAbzwvpG.js";import{r as L,a2 as W,a3 as q,A as X,v as H,c as I,U as Q,a4 as G,a5 as J,$ as K,a6 as Y,a7 as Z,q as tt,a8 as et}from"./ui-vendor-DelVp1tp.js";import{a as V,b as g,u as t,n as x,w as a,s,p as l,m as u,q as y,z as st,v as i,y as c,F as z,x as S,X as at,f as r,d as nt,r as w,c as M,o as lt,e as rt}from"./vue-vendor-BFreJ1An.js";import{_ as ot}from"./CoordinatorCard.vue_vue_type_script_setup_true_lang-BdpU3jp6.js";import{_ as D}from"./index-YgZVUsNe.js";import{_ as it,a as dt,b as O,c as k,d as ut,e as p}from"./TableHeader.vue_vue_type_script_setup_true_lang-BAK7VMpj.js";import{a as T}from"./index-BsTtUH7V.js";import{useOrganizationsStore as N}from"./organizations-BeLDuyV9.js";import{u as ct}from"./coordinators-cKpivT3u.js";import{f as mt}from"./format-DaYpM1Fu.js";import"./utils-vendor-B9ygI19o.js";const ft={class:"flex justify-between items-start mb-4"},gt={class:"space-y-1"},xt={key:0,class:"text-xs text-slate-400 mt-1"},bt={key:1,class:"text-xs text-slate-400 mt-1"},vt={key:0,class:"mt-4"},ht={class:"flex justify-between text-xs text-slate-500 mb-2"},yt={key:1,class:"mt-4 h-12 flex items-end gap-0.5"},F=V({__name:"MetricCard",props:{label:{},value:{},icon:{},trend:{},progress:{},sparkline:{},variant:{default:"default"},size:{default:"standard"},subStat:{},className:{}},setup(n){const d={default:"bg-blue-50 text-[#1B4F72]",success:"bg-green-50 text-green-600",warning:"bg-amber-50 text-amber-600",danger:"bg-red-50 text-red-600"},b={up:"text-green-600 bg-green-50",down:"text-red-600 bg-red-50",neutral:"text-slate-600 bg-slate-100"},f={default:"[&>div]:bg-[#1B4F72]",success:"[&>div]:bg-green-500",warning:"[&>div]:bg-amber-500",danger:"[&>div]:bg-red-500"},v={default:"bg-blue-200",success:"bg-green-200",warning:"bg-amber-200",danger:"bg-red-200"};return($,h)=>(r(),g(t(C),{class:x(["hover:shadow-md transition-shadow",n.size==="standard"?"p-6":"p-4"])},{default:a(()=>[s(t(A),null,{default:a(()=>[l("div",ft,[l("div",{class:x(["p-2.5 rounded-lg",d[n.variant]])},[(r(),g(st(n.icon),{size:n.size==="standard"?20:16},null,8,["size"]))],2),n.trend?(r(),g(t(R),{key:0,variant:n.trend.direction==="up"?"default":n.trend.direction==="down"?"destructive":"secondary",class:x(b[n.trend.direction])},{default:a(()=>[n.trend.direction==="up"?(r(),g(t(L),{key:0,size:12,class:"mr-1"})):n.trend.direction==="down"?(r(),g(t(W),{key:1,size:12,class:"mr-1"})):(r(),g(t(q),{key:2,size:12,class:"mr-1"})),i(" "+c(n.trend.value),1)]),_:1},8,["variant","class"])):y("",!0)]),l("div",gt,[l("h3",{class:x(["font-medium text-slate-500",n.size==="standard"?"text-sm":"text-xs"])},c(n.label),3),l("div",{class:x(["font-bold text-slate-900",n.size==="standard"?"text-3xl":"text-2xl"])},c(n.value),3),n.trend?.label?(r(),u("p",xt,c(n.trend.label),1)):y("",!0),n.subStat?(r(),u("p",bt,c(n.subStat),1)):y("",!0)]),n.progress?(r(),u("div",vt,[l("div",ht,[l("span",null,c(n.progress.label||"Progress"),1),l("span",null,c(n.progress.current)+" / "+c(n.progress.total),1)]),s(t(E),{"model-value":n.progress.current/n.progress.total*100,class:x(f[n.variant])},null,8,["model-value","class"])])):y("",!0),n.sparkline&&n.sparkline.length>0?(r(),u("div",yt,[(r(!0),u(z,null,S(n.sparkline,(e,m)=>(r(),u("div",{key:m,class:x(["flex-1 rounded-t transition-all duration-300",v[n.variant]]),style:at({height:`${e/Math.max(...n.sparkline)*100}%`})},null,6))),128))])):y("",!0)]),_:1})]),_:1},8,["class"]))}}),B={getMetrics:n=>T.get(`/coordinator/organizations/${n}/dashboard/metrics`),getRecentCalls:(n,d=10)=>T.get(`/coordinator/organizations/${n}/dashboard/recent-calls`,{params:{limit:d}}),getTodayAppointments:n=>T.get(`/coordinator/organizations/${n}/dashboard/today-appointments`)},_t=nt("dashboard",()=>{const n=w(null),d=w([]),b=w([]),f=w(!1),v=w(null);async function $(){const e=N();if(!e.currentOrganization?.id)throw new Error("No organization selected");f.value=!0,v.value=null;try{const[m,o,P]=await Promise.all([B.getMetrics(e.currentOrganization.id),B.getRecentCalls(e.currentOrganization.id),B.getTodayAppointments(e.currentOrganization.id)]);n.value=m.data,d.value=o.data.data,b.value=P.data.data}catch(m){throw v.value=m.response?.data?.message||"Failed to load dashboard data",m}finally{f.value=!1}}async function h(){const e=N();if(e.currentOrganization?.id)try{const m=await B.getMetrics(e.currentOrganization.id);n.value=m.data}catch(m){console.error("Failed to refresh metrics:",m)}}return{metrics:n,recentCalls:d,todayAppointments:b,loading:f,error:v,fetchDashboardData:$,refreshMetrics:h}}),pt={class:"space-y-8"},wt={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},kt={key:0,class:"text-center py-12"},Ct={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700"},zt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"},$t={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},Ft={class:"lg:col-span-2 space-y-8"},Bt={class:"flex justify-between items-center mb-4"},At={key:0,class:"text-slate-500 text-center py-8"},St={key:1,class:"text-slate-500 text-center py-8"},jt={key:2,class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Dt={class:"w-12 h-12 rounded-full bg-white border border-slate-200 flex items-center justify-center text-slate-400 group-hover:text-[#1B4F72] group-hover:border-[#1B4F72] mb-3 transition-colors shadow-sm"},Ot={class:"overflow-x-auto"},Tt={class:"space-y-8"},Nt={key:0,class:"text-slate-500 text-center py-8"},Mt={key:1,class:"relative pl-4 border-l-2 border-slate-100 space-y-8"},Rt={class:"flex flex-col"},Vt={class:"text-xs font-bold text-slate-400 mb-1"},Pt={class:"font-semibold text-slate-900"},Ut={class:"text-sm text-slate-500"},Et={class:"flex items-center gap-1 mt-1 text-xs text-slate-400"},Lt={class:"space-y-3"},se=V({__name:"DashboardPage",setup(n){const d=_t(),b=ct(),f=N(),v=M(()=>b.coordinators.filter(h=>h.status==="active"||h.status==="activated")),$=M(()=>d.metrics?.new_contacts_this_week??0);return lt(async()=>{try{f.currentOrganization||(await f.fetchOrganizations(),f.organizations.length>0&&f.setCurrentOrganization(f.organizations[0])),f.currentOrganization?.id&&await Promise.all([d.fetchDashboardData(),b.fetchCoordinators()])}catch(h){console.error("Failed to load dashboard:",h)}}),(h,e)=>{const m=rt("router-link");return r(),g(U,null,{default:a(()=>[l("div",pt,[l("div",wt,[e[1]||(e[1]=l("div",null,[l("h1",{class:"text-3xl font-heading font-bold text-[#1B4F72]"}," Dashboard "),l("p",{class:"text-slate-500 mt-1"}," Welcome back! Here's what's happening with your Coordinators. ")],-1)),s(t(_),{variant:"default",class:"bg-[#F59E0B] hover:bg-[#D97706] text-white","as-child":""},{default:a(()=>[s(m,{to:"/coordinators",class:"flex items-center gap-2"},{default:a(()=>[e[0]||(e[0]=i(" Manage Coordinators ",-1)),s(t(X),{size:18})]),_:1})]),_:1})]),t(d).loading?(r(),u("div",kt,[...e[2]||(e[2]=[l("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-[#1B4F72]"},null,-1),l("p",{class:"mt-4 text-slate-500"},"Loading dashboard data...",-1)])])):t(d).error?(r(),u("div",Ct,c(t(d).error),1)):(r(),u(z,{key:2},[l("div",zt,[s(F,{label:"Calls Today",value:t(d).metrics?.calls_today||0,icon:t(H),trend:t(d).metrics?.calls_today_trend},null,8,["value","icon","trend"]),s(F,{label:"Appointments This Week",value:t(d).metrics?.appointments_this_week||0,icon:t(I),trend:t(d).metrics?.appointments_trend},null,8,["value","icon","trend"]),s(F,{label:"Total Contacts",value:t(mt)(t(d).metrics?.total_contacts||0),icon:t(Q),"sub-stat":`+${$.value} new this week`},null,8,["value","icon","sub-stat"]),s(F,{label:"No-Show Rate",value:`${t(d).metrics?.no_show_rate||0}%`,icon:t(G),trend:t(d).metrics?.no_show_trend},null,8,["value","icon","trend"])]),l("div",$t,[l("div",Ft,[l("section",null,[l("div",Bt,[e[4]||(e[4]=l("h2",{class:"text-xl font-bold text-[#1B4F72]"}," Active Coordinators ",-1)),s(m,{to:"/coordinators",class:"text-sm font-medium text-[#1B4F72] hover:underline"},{default:a(()=>[...e[3]||(e[3]=[i(" View All ",-1)])]),_:1})]),t(b).loading?(r(),u("div",At," Loading coordinators... ")):v.value.length===0?(r(),u("div",St,[e[6]||(e[6]=i(" No active coordinators. ",-1)),s(m,{to:"/coordinators",class:"text-[#1B4F72] hover:underline"},{default:a(()=>[...e[5]||(e[5]=[i("Add one",-1)])]),_:1}),e[7]||(e[7]=i(" to get started. ",-1))])):(r(),u("div",jt,[(r(!0),u(z,null,S(v.value.slice(0,3),o=>(r(),g(ot,{key:o.id,id:o.id,name:o.display_name||o.role_template?.name||"Coordinator",role:o.role_template?.name||"Unknown Role",status:o.status==="active"?"active":"paused",compact:!0,"compact-stats":"15 calls"},null,8,["id","name","role","status"]))),128)),s(t(C),{class:"border-2 border-dashed border-slate-300 hover:border-[#1B4F72] hover:bg-blue-50/50 transition-all duration-200 flex flex-col items-center justify-center p-6 group cursor-pointer h-full min-h-[200px] bg-slate-50","as-child":""},{default:a(()=>[s(m,{to:"/coordinators",class:"flex flex-col items-center justify-center w-full h-full"},{default:a(()=>[l("div",Dt,[s(t(J),{size:24})]),e[8]||(e[8]=l("span",{class:"font-medium text-slate-600 group-hover:text-[#1B4F72]"}," Add Coordinator ",-1))]),_:1})]),_:1})]))]),s(t(C),{class:"overflow-hidden"},{default:a(()=>[s(t(j),{class:"flex flex-row items-center justify-between"},{default:a(()=>[s(t(D),{class:"text-xl font-bold text-[#1B4F72]"},{default:a(()=>[...e[9]||(e[9]=[i("Recent Calls",-1)])]),_:1}),s(t(_),{variant:"ghost",size:"sm","as-child":""},{default:a(()=>[s(m,{to:"/calls"},{default:a(()=>[...e[10]||(e[10]=[i("View All",-1)])]),_:1})]),_:1})]),_:1}),s(t(A),null,{default:a(()=>[l("div",Ot,[s(t(it),null,{default:a(()=>[s(t(dt),null,{default:a(()=>[s(t(O),null,{default:a(()=>[s(t(k),null,{default:a(()=>[...e[11]||(e[11]=[i("Time",-1)])]),_:1}),s(t(k),null,{default:a(()=>[...e[12]||(e[12]=[i("Contact",-1)])]),_:1}),s(t(k),null,{default:a(()=>[...e[13]||(e[13]=[i("Coordinator",-1)])]),_:1}),s(t(k),null,{default:a(()=>[...e[14]||(e[14]=[i("Duration",-1)])]),_:1}),s(t(k),null,{default:a(()=>[...e[15]||(e[15]=[i("Outcome",-1)])]),_:1})]),_:1})]),_:1}),s(t(ut),null,{default:a(()=>[(r(!0),u(z,null,S(t(d).recentCalls,o=>(r(),g(t(O),{key:o.id,class:"hover:bg-slate-50 transition-colors cursor-pointer"},{default:a(()=>[s(t(p),{class:"text-slate-500"},{default:a(()=>[i(c(o.time),1)]),_:2},1024),s(t(p),{class:"font-medium text-slate-900"},{default:a(()=>[i(c(o.contact_name),1)]),_:2},1024),s(t(p),{class:"text-slate-600"},{default:a(()=>[i(c(o.coordinator_name),1)]),_:2},1024),s(t(p),{class:"text-slate-500 font-mono text-xs"},{default:a(()=>[i(c(o.duration),1)]),_:2},1024),s(t(p),null,{default:a(()=>[s(t(R),{variant:o.status==="success"?"default":o.status==="error"?"destructive":"secondary",class:x(o.status==="success"?"bg-green-50 text-green-700":o.status==="error"?"bg-red-50 text-red-700":"bg-slate-100 text-slate-600")},{default:a(()=>[i(c(o.outcome),1)]),_:2},1032,["variant","class"])]),_:2},1024)]),_:2},1024))),128)),t(d).recentCalls.length===0?(r(),g(t(O),{key:0},{default:a(()=>[s(t(p),{colspan:"5",class:"text-center text-slate-500 py-8"},{default:a(()=>[...e[16]||(e[16]=[i(" No recent calls ",-1)])]),_:1})]),_:1})):y("",!0)]),_:1})]),_:1})])]),_:1})]),_:1})]),l("div",Tt,[s(t(C),null,{default:a(()=>[s(t(j),{class:"flex flex-row items-center justify-between"},{default:a(()=>[s(t(D),{class:"text-xl font-bold text-[#1B4F72]"},{default:a(()=>[...e[17]||(e[17]=[i(" Today's Appointments ",-1)])]),_:1}),s(t(_),{variant:"ghost",size:"sm","as-child":""},{default:a(()=>[s(m,{to:"/appointments"},{default:a(()=>[...e[18]||(e[18]=[i("View Calendar",-1)])]),_:1})]),_:1})]),_:1}),s(t(A),null,{default:a(()=>[t(d).todayAppointments.length===0?(r(),u("div",Nt," No appointments today ")):(r(),u("div",Mt,[(r(!0),u(z,null,S(t(d).todayAppointments,o=>(r(),u("div",{key:o.id,class:"relative"},[l("div",{class:x(["absolute -left-[21px] top-1 w-3 h-3 rounded-full border-2 border-white shadow-sm",o.status==="confirmed"?"bg-green-500":o.status==="pending"?"bg-amber-500":"bg-red-500"])},null,2),l("div",Rt,[l("span",Vt,c(o.time),1),l("h4",Pt,c(o.contact_name),1),l("p",Ut,c(o.type),1),l("div",Et,[l("span",null,"via "+c(o.coordinator_name),1),o.status==="confirmed"?(r(),g(t(K),{key:0,size:12,class:"text-green-500 ml-1"})):y("",!0),o.status==="cancelled"?(r(),g(t(Y),{key:1,size:12,class:"text-red-500 ml-1"})):y("",!0)])])]))),128))]))]),_:1})]),_:1}),s(t(C),null,{default:a(()=>[s(t(j),null,{default:a(()=>[s(t(D),{class:"text-xl font-bold text-[#1B4F72]"},{default:a(()=>[...e[19]||(e[19]=[i(" Quick Actions ",-1)])]),_:1})]),_:1}),s(t(A),null,{default:a(()=>[l("div",Lt,[s(t(_),{variant:"outline",class:"w-full justify-start h-auto p-3"},{default:a(()=>[s(t(Z),{size:18,class:"mr-3"}),e[20]||(e[20]=i(" Import Contacts ",-1))]),_:1}),s(t(_),{variant:"outline",class:"w-full justify-start h-auto p-3"},{default:a(()=>[s(t(tt),{size:18,class:"mr-3"}),e[21]||(e[21]=i(" Create Campaign ",-1))]),_:1}),s(t(_),{variant:"outline",class:"w-full justify-start h-auto p-3"},{default:a(()=>[s(t(et),{size:18,class:"mr-3"}),e[22]||(e[22]=i(" View Analytics ",-1))]),_:1})])]),_:1})]),_:1})])])],64))])]),_:1})}}});export{se as default};
