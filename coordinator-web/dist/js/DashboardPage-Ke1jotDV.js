import{_ as D}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-BFNf4mOZ.js";import{$ as O,a0 as N,a1 as T,A as M,s as R,c as V,U as j,a2 as P,a3 as U,V as E,a4 as L,a5 as W,n as q,a6 as H}from"./ui-vendor-o_tb4bfv.js";import{a as $,m as l,p as t,q as f,b as x,z as I,n as F,v as m,u as s,y as c,f as a,d as Q,r as v,c as A,o as X,w as b,s as d,e as G,F as _,x as k}from"./vue-vendor-u6tZf2HN.js";import{_ as J}from"./CoordinatorCard.vue_vue_type_script_setup_true_lang-DKANeqly.js";import{a as z}from"./index-14mik_sv.js";import{useOrganizationsStore as B}from"./organizations-BtYa45au.js";import{u as K}from"./coordinators-CXVT1hhI.js";import{f as Y}from"./format-DaYpM1Fu.js";import"./utils-vendor-B9ygI19o.js";const Z={class:"bg-white rounded-xl border border-slate-100 p-6 shadow-sm hover:shadow-md transition-shadow"},tt={class:"flex justify-between items-start mb-4"},et={class:"p-2.5 bg-blue-50 text-[#1B4F72] rounded-lg"},st={class:"space-y-1"},ot={class:"text-sm font-medium text-slate-500"},at={class:"text-3xl font-bold text-slate-900"},rt={key:0,class:"text-xs text-slate-400 mt-1"},nt={key:1,class:"text-xs text-slate-400 mt-1"},y=$({__name:"MetricCard",props:{title:{},value:{},icon:{},trend:{},subStat:{}},setup(r){return(n,g)=>(a(),l("div",Z,[t("div",tt,[t("div",et,[(a(),x(I(r.icon),{size:20}))]),r.trend?(a(),l("div",{key:0,class:F(["flex items-center text-xs font-medium px-2 py-1 rounded-full",r.trend.direction==="up"?"text-green-700 bg-green-50":r.trend.direction==="down"?"text-red-700 bg-red-50":"text-slate-600 bg-slate-100"])},[r.trend.direction==="up"?(a(),x(s(O),{key:0,size:12,class:"mr-1"})):r.trend.direction==="down"?(a(),x(s(N),{key:1,size:12,class:"mr-1"})):(a(),x(s(T),{key:2,size:12,class:"mr-1"})),m(" "+c(r.trend.value),1)],2)):f("",!0)]),t("div",st,[t("h3",ot,c(r.title),1),t("div",at,c(r.value),1),r.subStat?(a(),l("p",rt,c(r.subStat),1)):f("",!0),r.trend?.label?(a(),l("p",nt,c(r.trend.label),1)):f("",!0)])]))}}),w={getMetrics:r=>z.get(`/coordinator/organizations/${r}/dashboard/metrics`),getRecentCalls:(r,n=10)=>z.get(`/coordinator/organizations/${r}/dashboard/recent-calls`,{params:{limit:n}}),getTodayAppointments:r=>z.get(`/coordinator/organizations/${r}/dashboard/today-appointments`)},lt=Q("dashboard",()=>{const r=v(null),n=v([]),g=v([]),u=v(!1),p=v(null);async function C(){const e=B();if(!e.currentOrganization?.id)throw new Error("No organization selected");u.value=!0,p.value=null;try{const[i,o,S]=await Promise.all([w.getMetrics(e.currentOrganization.id),w.getRecentCalls(e.currentOrganization.id),w.getTodayAppointments(e.currentOrganization.id)]);r.value=i.data,n.value=o.data.data,g.value=S.data.data}catch(i){throw p.value=i.response?.data?.message||"Failed to load dashboard data",i}finally{u.value=!1}}async function h(){const e=B();if(e.currentOrganization?.id)try{const i=await w.getMetrics(e.currentOrganization.id);r.value=i.data}catch(i){console.error("Failed to refresh metrics:",i)}}return{metrics:r,recentCalls:n,todayAppointments:g,loading:u,error:p,fetchDashboardData:C,refreshMetrics:h}}),it={class:"space-y-8"},dt={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},ct={key:0,class:"text-center py-12"},ut={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700"},mt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"},xt={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},gt={class:"lg:col-span-2 space-y-8"},ht={class:"flex justify-between items-center mb-4"},bt={key:0,class:"text-slate-500 text-center py-8"},pt={key:1,class:"text-slate-500 text-center py-8"},ft={key:2,class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},vt={class:"w-12 h-12 rounded-full bg-white border border-slate-200 flex items-center justify-center text-slate-400 group-hover:text-[#1B4F72] group-hover:border-[#1B4F72] mb-3 transition-colors shadow-sm"},_t={class:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden"},yt={class:"p-6 border-b border-slate-100 flex justify-between items-center"},wt={class:"overflow-x-auto"},Ct={class:"w-full text-sm text-left"},kt={class:"divide-y divide-slate-100"},zt={class:"px-6 py-4 text-slate-500"},Ft={class:"px-6 py-4 font-medium text-slate-900"},Bt={class:"px-6 py-4 text-slate-600"},At={class:"px-6 py-4 text-slate-500 font-mono text-xs"},$t={class:"px-6 py-4"},St={key:0},Dt={class:"space-y-8"},Ot={class:"bg-white rounded-xl border border-slate-200 shadow-sm p-6"},Nt={class:"flex justify-between items-center mb-6"},Tt={key:0,class:"text-slate-500 text-center py-8"},Mt={key:1,class:"relative pl-4 border-l-2 border-slate-100 space-y-8"},Rt={class:"flex flex-col"},Vt={class:"text-xs font-bold text-slate-400 mb-1"},jt={class:"font-semibold text-slate-900"},Pt={class:"text-sm text-slate-500"},Ut={class:"flex items-center gap-1 mt-1 text-xs text-slate-400"},Et={class:"bg-white rounded-xl border border-slate-200 shadow-sm p-6"},Lt={class:"space-y-3"},Wt={class:"w-full flex items-center gap-3 p-3 rounded-lg border border-slate-200 hover:border-[#1B4F72] hover:bg-blue-50 transition-all text-left group"},qt={class:"p-2 bg-slate-100 text-slate-600 rounded-lg group-hover:bg-white group-hover:text-[#1B4F72]"},Ht={class:"w-full flex items-center gap-3 p-3 rounded-lg border border-slate-200 hover:border-[#1B4F72] hover:bg-blue-50 transition-all text-left group"},It={class:"p-2 bg-slate-100 text-slate-600 rounded-lg group-hover:bg-white group-hover:text-[#1B4F72]"},Qt={class:"w-full flex items-center gap-3 p-3 rounded-lg border border-slate-200 hover:border-[#1B4F72] hover:bg-blue-50 transition-all text-left group"},Xt={class:"p-2 bg-slate-100 text-slate-600 rounded-lg group-hover:bg-white group-hover:text-[#1B4F72]"},ae=$({__name:"DashboardPage",setup(r){const n=lt(),g=K(),u=B(),p=A(()=>g.coordinators.filter(h=>h.status==="active"||h.status==="activated")),C=A(()=>n.metrics?.new_contacts_this_week??0);return X(async()=>{try{u.currentOrganization||(await u.fetchOrganizations(),u.organizations.length>0&&u.setCurrentOrganization(u.organizations[0])),u.currentOrganization?.id&&await Promise.all([n.fetchDashboardData(),g.fetchCoordinators()])}catch(h){console.error("Failed to load dashboard:",h)}}),(h,e)=>{const i=G("router-link");return a(),x(D,null,{default:b(()=>[t("div",it,[t("div",dt,[e[1]||(e[1]=t("div",null,[t("h1",{class:"text-3xl font-heading font-bold text-[#1B4F72]"}," Dashboard "),t("p",{class:"text-slate-500 mt-1"}," Welcome back! Here's what's happening with your Coordinators. ")],-1)),d(i,{to:"/coordinators",class:"px-5 py-2.5 bg-[#F59E0B] hover:bg-[#D97706] text-white font-semibold rounded-lg shadow-sm hover:shadow-md transition-all duration-200 flex items-center gap-2"},{default:b(()=>[e[0]||(e[0]=m(" Manage Coordinators ",-1)),d(s(M),{size:18})]),_:1})]),s(n).loading?(a(),l("div",ct,[...e[2]||(e[2]=[t("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-[#1B4F72]"},null,-1),t("p",{class:"mt-4 text-slate-500"},"Loading dashboard data...",-1)])])):s(n).error?(a(),l("div",ut,c(s(n).error),1)):(a(),l(_,{key:2},[t("div",mt,[d(y,{title:"Calls Today",value:s(n).metrics?.calls_today||0,icon:s(R),trend:s(n).metrics?.calls_today_trend},null,8,["value","icon","trend"]),d(y,{title:"Appointments This Week",value:s(n).metrics?.appointments_this_week||0,icon:s(V),trend:s(n).metrics?.appointments_trend},null,8,["value","icon","trend"]),d(y,{title:"Total Contacts",value:s(Y)(s(n).metrics?.total_contacts||0),icon:s(j),"sub-stat":`+${C.value} new this week`},null,8,["value","icon","sub-stat"]),d(y,{title:"No-Show Rate",value:`${s(n).metrics?.no_show_rate||0}%`,icon:s(P),trend:s(n).metrics?.no_show_trend},null,8,["value","icon","trend"])]),t("div",xt,[t("div",gt,[t("section",null,[t("div",ht,[e[4]||(e[4]=t("h2",{class:"text-xl font-bold text-[#1B4F72]"}," Active Coordinators ",-1)),d(i,{to:"/coordinators",class:"text-sm font-medium text-[#1B4F72] hover:underline"},{default:b(()=>[...e[3]||(e[3]=[m(" View All ",-1)])]),_:1})]),s(g).loading?(a(),l("div",bt," Loading coordinators... ")):p.value.length===0?(a(),l("div",pt,[e[6]||(e[6]=m(" No active coordinators. ",-1)),d(i,{to:"/coordinators",class:"text-[#1B4F72] hover:underline"},{default:b(()=>[...e[5]||(e[5]=[m("Add one",-1)])]),_:1}),e[7]||(e[7]=m(" to get started. ",-1))])):(a(),l("div",ft,[(a(!0),l(_,null,k(p.value.slice(0,3),o=>(a(),x(J,{key:o.id,id:o.id,name:o.display_name||o.role_template?.name||"Coordinator",role:o.role_template?.name||"Unknown Role",status:o.status==="active"?"active":"paused",compact:!0,"compact-stats":"15 calls"},null,8,["id","name","role","status"]))),128)),d(i,{to:"/coordinators",class:"bg-slate-50 rounded-xl border-2 border-dashed border-slate-300 hover:border-[#1B4F72] hover:bg-blue-50/50 transition-all duration-200 flex flex-col items-center justify-center p-6 group cursor-pointer h-full min-h-[200px]"},{default:b(()=>[t("div",vt,[d(s(U),{size:24})]),e[8]||(e[8]=t("span",{class:"font-medium text-slate-600 group-hover:text-[#1B4F72]"}," Add Coordinator ",-1))]),_:1})]))]),t("section",_t,[t("div",yt,[e[10]||(e[10]=t("h2",{class:"text-xl font-bold text-[#1B4F72]"},"Recent Calls",-1)),d(i,{to:"/calls",class:"text-sm font-medium text-[#1B4F72] hover:underline"},{default:b(()=>[...e[9]||(e[9]=[m(" View All ",-1)])]),_:1})]),t("div",wt,[t("table",Ct,[e[12]||(e[12]=t("thead",{class:"bg-slate-50 text-slate-500 font-medium border-b border-slate-100"},[t("tr",null,[t("th",{class:"px-6 py-3"},"Time"),t("th",{class:"px-6 py-3"},"Contact"),t("th",{class:"px-6 py-3"},"Coordinator"),t("th",{class:"px-6 py-3"},"Duration"),t("th",{class:"px-6 py-3"},"Outcome")])],-1)),t("tbody",kt,[(a(!0),l(_,null,k(s(n).recentCalls,o=>(a(),l("tr",{key:o.id,class:"hover:bg-slate-50 transition-colors"},[t("td",zt,c(o.time),1),t("td",Ft,c(o.contact_name),1),t("td",Bt,c(o.coordinator_name),1),t("td",At,c(o.duration),1),t("td",$t,[t("span",{class:F(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",o.status==="success"?"bg-green-50 text-green-700":o.status==="error"?"bg-red-50 text-red-700":"bg-slate-100 text-slate-600"])},c(o.outcome),3)])]))),128)),s(n).recentCalls.length===0?(a(),l("tr",St,[...e[11]||(e[11]=[t("td",{colspan:"5",class:"px-6 py-8 text-center text-slate-500"}," No recent calls ",-1)])])):f("",!0)])])])])]),t("div",Dt,[t("section",Ot,[t("div",Nt,[e[14]||(e[14]=t("h2",{class:"text-xl font-bold text-[#1B4F72]"}," Today's Appointments ",-1)),d(i,{to:"/appointments",class:"text-sm font-medium text-[#1B4F72] hover:underline"},{default:b(()=>[...e[13]||(e[13]=[m(" View Calendar ",-1)])]),_:1})]),s(n).todayAppointments.length===0?(a(),l("div",Tt," No appointments today ")):(a(),l("div",Mt,[(a(!0),l(_,null,k(s(n).todayAppointments,o=>(a(),l("div",{key:o.id,class:"relative"},[t("div",{class:F(["absolute -left-[21px] top-1 w-3 h-3 rounded-full border-2 border-white shadow-sm",o.status==="confirmed"?"bg-green-500":o.status==="pending"?"bg-amber-500":"bg-red-500"])},null,2),t("div",Rt,[t("span",Vt,c(o.time),1),t("h4",jt,c(o.contact_name),1),t("p",Pt,c(o.type),1),t("div",Ut,[t("span",null,"via "+c(o.coordinator_name),1),o.status==="confirmed"?(a(),x(s(E),{key:0,size:12,class:"text-green-500 ml-1"})):f("",!0),o.status==="cancelled"?(a(),x(s(L),{key:1,size:12,class:"text-red-500 ml-1"})):f("",!0)])])]))),128))]))]),t("section",Et,[e[18]||(e[18]=t("h2",{class:"text-xl font-bold text-[#1B4F72] mb-4"}," Quick Actions ",-1)),t("div",Lt,[t("button",Wt,[t("div",qt,[d(s(W),{size:18})]),e[15]||(e[15]=t("span",{class:"font-medium text-slate-700 group-hover:text-[#1B4F72]"}," Import Contacts ",-1))]),t("button",Ht,[t("div",It,[d(s(q),{size:18})]),e[16]||(e[16]=t("span",{class:"font-medium text-slate-700 group-hover:text-[#1B4F72]"}," Create Campaign ",-1))]),t("button",Qt,[t("div",Xt,[d(s(H),{size:18})]),e[17]||(e[17]=t("span",{class:"font-medium text-slate-700 group-hover:text-[#1B4F72]"}," View Analytics ",-1))])])])])])],64))])]),_:1})}}});export{ae as default};
